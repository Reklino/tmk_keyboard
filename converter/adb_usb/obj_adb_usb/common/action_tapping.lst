   1               		.file	"action_tapping.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               		.section	.text.debug_waiting_buffer,"ax",@progbits
  12               	debug_waiting_buffer:
  13               	.LFB11:
  14               		.file 1 "../../tmk_core/common/action_tapping.c"
   1:../../tmk_core/common/action_tapping.c **** #include <stdint.h>
   2:../../tmk_core/common/action_tapping.c **** #include <stdbool.h>
   3:../../tmk_core/common/action_tapping.c **** #include "action.h"
   4:../../tmk_core/common/action_tapping.c **** #include "action_layer.h"
   5:../../tmk_core/common/action_tapping.c **** #include "action_tapping.h"
   6:../../tmk_core/common/action_tapping.c **** #include "keycode.h"
   7:../../tmk_core/common/action_tapping.c **** #include "timer.h"
   8:../../tmk_core/common/action_tapping.c **** 
   9:../../tmk_core/common/action_tapping.c **** #ifdef DEBUG_ACTION
  10:../../tmk_core/common/action_tapping.c **** #include "debug.h"
  11:../../tmk_core/common/action_tapping.c **** #else
  12:../../tmk_core/common/action_tapping.c **** #include "nodebug.h"
  13:../../tmk_core/common/action_tapping.c **** #endif
  14:../../tmk_core/common/action_tapping.c **** 
  15:../../tmk_core/common/action_tapping.c **** #ifndef NO_ACTION_TAPPING
  16:../../tmk_core/common/action_tapping.c **** 
  17:../../tmk_core/common/action_tapping.c **** #define IS_TAPPING()            !IS_NOEVENT(tapping_key.event)
  18:../../tmk_core/common/action_tapping.c **** #define IS_TAPPING_PRESSED()    (IS_TAPPING() && tapping_key.event.pressed)
  19:../../tmk_core/common/action_tapping.c **** #define IS_TAPPING_RELEASED()   (IS_TAPPING() && !tapping_key.event.pressed)
  20:../../tmk_core/common/action_tapping.c **** #define IS_TAPPING_KEY(k)       (IS_TAPPING() && KEYEQ(tapping_key.event.key, (k)))
  21:../../tmk_core/common/action_tapping.c **** #define WITHIN_TAPPING_TERM(e)  (TIMER_DIFF_16(e.time, tapping_key.event.time) < TAPPING_TERM)
  22:../../tmk_core/common/action_tapping.c **** 
  23:../../tmk_core/common/action_tapping.c **** 
  24:../../tmk_core/common/action_tapping.c **** static keyrecord_t tapping_key = {};
  25:../../tmk_core/common/action_tapping.c **** static keyrecord_t waiting_buffer[WAITING_BUFFER_SIZE] = {};
  26:../../tmk_core/common/action_tapping.c **** static uint8_t waiting_buffer_head = 0;
  27:../../tmk_core/common/action_tapping.c **** static uint8_t waiting_buffer_tail = 0;
  28:../../tmk_core/common/action_tapping.c **** 
  29:../../tmk_core/common/action_tapping.c **** static bool process_tapping(keyrecord_t *record);
  30:../../tmk_core/common/action_tapping.c **** static bool waiting_buffer_enq(keyrecord_t record);
  31:../../tmk_core/common/action_tapping.c **** static void waiting_buffer_clear(void);
  32:../../tmk_core/common/action_tapping.c **** static bool waiting_buffer_typed(keyevent_t event);
  33:../../tmk_core/common/action_tapping.c **** static void waiting_buffer_scan_tap(void);
  34:../../tmk_core/common/action_tapping.c **** static void debug_tapping_key(void);
  35:../../tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void);
  36:../../tmk_core/common/action_tapping.c **** 
  37:../../tmk_core/common/action_tapping.c **** 
  38:../../tmk_core/common/action_tapping.c **** void action_tapping_process(keyrecord_t record)
  39:../../tmk_core/common/action_tapping.c **** {
  40:../../tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
  41:../../tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
  42:../../tmk_core/common/action_tapping.c ****             debug("processed: "); debug_record(record); debug("\n");
  43:../../tmk_core/common/action_tapping.c ****         }
  44:../../tmk_core/common/action_tapping.c ****     } else {
  45:../../tmk_core/common/action_tapping.c ****         if (!waiting_buffer_enq(record)) {
  46:../../tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
  47:../../tmk_core/common/action_tapping.c ****             debug("OVERFLOW: CLEAR ALL STATES\n");
  48:../../tmk_core/common/action_tapping.c ****             clear_keyboard();
  49:../../tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
  50:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
  51:../../tmk_core/common/action_tapping.c ****         }
  52:../../tmk_core/common/action_tapping.c ****     }
  53:../../tmk_core/common/action_tapping.c **** 
  54:../../tmk_core/common/action_tapping.c ****     // process waiting_buffer
  55:../../tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event) && waiting_buffer_head != waiting_buffer_tail) {
  56:../../tmk_core/common/action_tapping.c ****         debug("---- action_exec: process waiting_buffer -----\n");
  57:../../tmk_core/common/action_tapping.c ****     }
  58:../../tmk_core/common/action_tapping.c ****     for (; waiting_buffer_tail != waiting_buffer_head; waiting_buffer_tail = (waiting_buffer_tail +
  59:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
  60:../../tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
  61:../../tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
  62:../../tmk_core/common/action_tapping.c ****         } else {
  63:../../tmk_core/common/action_tapping.c ****             break;
  64:../../tmk_core/common/action_tapping.c ****         }
  65:../../tmk_core/common/action_tapping.c ****     }
  66:../../tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event)) {
  67:../../tmk_core/common/action_tapping.c ****         debug("\n");
  68:../../tmk_core/common/action_tapping.c ****     }
  69:../../tmk_core/common/action_tapping.c **** }
  70:../../tmk_core/common/action_tapping.c **** 
  71:../../tmk_core/common/action_tapping.c **** 
  72:../../tmk_core/common/action_tapping.c **** /* Tapping
  73:../../tmk_core/common/action_tapping.c ****  *
  74:../../tmk_core/common/action_tapping.c ****  * Rule: Tap key is typed(pressed and released) within TAPPING_TERM.
  75:../../tmk_core/common/action_tapping.c ****  *       (without interfering by typing other key)
  76:../../tmk_core/common/action_tapping.c ****  */
  77:../../tmk_core/common/action_tapping.c **** /* return true when key event is processed or consumed. */
  78:../../tmk_core/common/action_tapping.c **** bool process_tapping(keyrecord_t *keyp)
  79:../../tmk_core/common/action_tapping.c **** {
  80:../../tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
  81:../../tmk_core/common/action_tapping.c **** 
  82:../../tmk_core/common/action_tapping.c ****     // if tapping
  83:../../tmk_core/common/action_tapping.c ****     if (IS_TAPPING_PRESSED()) {
  84:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
  85:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
  86:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
  87:../../tmk_core/common/action_tapping.c ****                     // first tap!
  88:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: First tap(0->1).\n");
  89:../../tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
  90:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
  91:../../tmk_core/common/action_tapping.c ****                     process_action(&tapping_key);
  92:../../tmk_core/common/action_tapping.c **** 
  93:../../tmk_core/common/action_tapping.c ****                     // copy tapping state
  94:../../tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
  95:../../tmk_core/common/action_tapping.c ****                     // enqueue
  96:../../tmk_core/common/action_tapping.c ****                     return false;
  97:../../tmk_core/common/action_tapping.c ****                 }
  98:../../tmk_core/common/action_tapping.c **** #if TAPPING_TERM >= 500
  99:../../tmk_core/common/action_tapping.c ****                 /* Process a key typed within TAPPING_TERM
 100:../../tmk_core/common/action_tapping.c ****                  * This can register the key before settlement of tapping,
 101:../../tmk_core/common/action_tapping.c ****                  * useful for long TAPPING_TERM but may prevent fast typing.
 102:../../tmk_core/common/action_tapping.c ****                  */
 103:../../tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && waiting_buffer_typed(event)) {
 104:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: End. No tap. Interfered by typing key\n");
 105:../../tmk_core/common/action_tapping.c ****                     process_action(&tapping_key);
 106:../../tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 107:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 108:../../tmk_core/common/action_tapping.c ****                     // enqueue
 109:../../tmk_core/common/action_tapping.c ****                     return false;
 110:../../tmk_core/common/action_tapping.c ****                 }
 111:../../tmk_core/common/action_tapping.c **** #endif
 112:../../tmk_core/common/action_tapping.c ****                 /* Process release event of a key pressed before tapping starts
 113:../../tmk_core/common/action_tapping.c ****                  * Without this unexpected repeating will occur with having fast repeating setting
 114:../../tmk_core/common/action_tapping.c ****                  * https://github.com/tmk/tmk_keyboard/issues/60
 115:../../tmk_core/common/action_tapping.c ****                  */
 116:../../tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && !waiting_buffer_typed(event)) {
 117:../../tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 118:../../tmk_core/common/action_tapping.c ****                     action_t action = layer_switch_get_action(event);
 119:../../tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 120:../../tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 121:../../tmk_core/common/action_tapping.c ****                         case ACT_RMODS:
 122:../../tmk_core/common/action_tapping.c ****                             if (action.key.mods && !action.key.code) return false;
 123:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 124:../../tmk_core/common/action_tapping.c ****                             break;
 125:../../tmk_core/common/action_tapping.c ****                         case ACT_LMODS_TAP:
 126:../../tmk_core/common/action_tapping.c ****                         case ACT_RMODS_TAP:
 127:../../tmk_core/common/action_tapping.c ****                             if (action.key.mods && keyp->tap.count == 0) return false;
 128:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 129:../../tmk_core/common/action_tapping.c ****                             break;
 130:../../tmk_core/common/action_tapping.c ****                     }
 131:../../tmk_core/common/action_tapping.c ****                     // Release of key should be process immediately.
 132:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: release event of a key pressed before tapping\n");
 133:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 134:../../tmk_core/common/action_tapping.c ****                     return true;
 135:../../tmk_core/common/action_tapping.c ****                 }
 136:../../tmk_core/common/action_tapping.c ****                 else {
 137:../../tmk_core/common/action_tapping.c ****                     // set interrupted flag when other key preesed during tapping
 138:../../tmk_core/common/action_tapping.c ****                     if (event.pressed) {
 139:../../tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 140:../../tmk_core/common/action_tapping.c ****                     }
 141:../../tmk_core/common/action_tapping.c ****                     // enqueue 
 142:../../tmk_core/common/action_tapping.c ****                     return false;
 143:../../tmk_core/common/action_tapping.c ****                 }
 144:../../tmk_core/common/action_tapping.c ****             }
 145:../../tmk_core/common/action_tapping.c ****             // tap_count > 0
 146:../../tmk_core/common/action_tapping.c ****             else {
 147:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 148:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 149:../../tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 150:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 151:../../tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 152:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 153:../../tmk_core/common/action_tapping.c ****                     return true;
 154:../../tmk_core/common/action_tapping.c ****                 }
 155:../../tmk_core/common/action_tapping.c ****                 else if (is_tap_key(event) && event.pressed) {
 156:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 157:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 158:../../tmk_core/common/action_tapping.c ****                         // unregister key
 159:../../tmk_core/common/action_tapping.c ****                         process_action(&(keyrecord_t){
 160:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 161:../../tmk_core/common/action_tapping.c ****                                 .event.key = tapping_key.event.key,
 162:../../tmk_core/common/action_tapping.c ****                                 .event.time = event.time,
 163:../../tmk_core/common/action_tapping.c ****                                 .event.pressed = false
 164:../../tmk_core/common/action_tapping.c ****                         });
 165:../../tmk_core/common/action_tapping.c ****                     } else {
 166:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last tap(1).\n");
 167:../../tmk_core/common/action_tapping.c ****                     }
 168:../../tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 169:../../tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 170:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 171:../../tmk_core/common/action_tapping.c ****                     return true;
 172:../../tmk_core/common/action_tapping.c ****                 }
 173:../../tmk_core/common/action_tapping.c ****                 else {
 174:../../tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 175:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 176:../../tmk_core/common/action_tapping.c ****                     }
 177:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 178:../../tmk_core/common/action_tapping.c ****                     return true;
 179:../../tmk_core/common/action_tapping.c ****                 }
 180:../../tmk_core/common/action_tapping.c ****             }
 181:../../tmk_core/common/action_tapping.c ****         }
 182:../../tmk_core/common/action_tapping.c ****         // after TAPPING_TERM
 183:../../tmk_core/common/action_tapping.c ****         else {
 184:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 185:../../tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 186:../../tmk_core/common/action_tapping.c ****                 debug_event(event); debug("\n");
 187:../../tmk_core/common/action_tapping.c ****                 process_action(&tapping_key);
 188:../../tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 189:../../tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 190:../../tmk_core/common/action_tapping.c ****                 return false;
 191:../../tmk_core/common/action_tapping.c ****             }  else {
 192:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 193:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 194:../../tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 195:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 196:../../tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 197:../../tmk_core/common/action_tapping.c ****                     return true;
 198:../../tmk_core/common/action_tapping.c ****                 }
 199:../../tmk_core/common/action_tapping.c ****                 else if (is_tap_key(event) && event.pressed) {
 200:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 201:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 202:../../tmk_core/common/action_tapping.c ****                         // unregister key
 203:../../tmk_core/common/action_tapping.c ****                         process_action(&(keyrecord_t){
 204:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 205:../../tmk_core/common/action_tapping.c ****                                 .event.key = tapping_key.event.key,
 206:../../tmk_core/common/action_tapping.c ****                                 .event.time = event.time,
 207:../../tmk_core/common/action_tapping.c ****                                 .event.pressed = false
 208:../../tmk_core/common/action_tapping.c ****                         });
 209:../../tmk_core/common/action_tapping.c ****                     } else {
 210:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last timeout tap(1).\n");
 211:../../tmk_core/common/action_tapping.c ****                     }
 212:../../tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 213:../../tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 214:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 215:../../tmk_core/common/action_tapping.c ****                     return true;
 216:../../tmk_core/common/action_tapping.c ****                 }
 217:../../tmk_core/common/action_tapping.c ****                 else {
 218:../../tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 219:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last timeout tap(>0).\n");
 220:../../tmk_core/common/action_tapping.c ****                     }
 221:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 222:../../tmk_core/common/action_tapping.c ****                     return true;
 223:../../tmk_core/common/action_tapping.c ****                 }
 224:../../tmk_core/common/action_tapping.c ****             }
 225:../../tmk_core/common/action_tapping.c ****         }
 226:../../tmk_core/common/action_tapping.c ****     } else if (IS_TAPPING_RELEASED()) {
 227:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 228:../../tmk_core/common/action_tapping.c ****             if (event.pressed) {
 229:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 230:../../tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 231:../../tmk_core/common/action_tapping.c ****                         // sequential tap.
 232:../../tmk_core/common/action_tapping.c ****                         keyp->tap = tapping_key.tap;
 233:../../tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 234:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 235:../../tmk_core/common/action_tapping.c ****                         process_action(keyp);
 236:../../tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 237:../../tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 238:../../tmk_core/common/action_tapping.c ****                         return true;
 239:../../tmk_core/common/action_tapping.c ****                     } else {
 240:../../tmk_core/common/action_tapping.c ****                         // FIX: start new tap again
 241:../../tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 242:../../tmk_core/common/action_tapping.c ****                         return true;
 243:../../tmk_core/common/action_tapping.c ****                     }
 244:../../tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event)) {
 245:../../tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 246:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: Start with interfering other tap.\n");
 247:../../tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 248:../../tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 249:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 250:../../tmk_core/common/action_tapping.c ****                     return true;
 251:../../tmk_core/common/action_tapping.c ****                 } else {
 252:../../tmk_core/common/action_tapping.c ****                     // should none in buffer
 253:../../tmk_core/common/action_tapping.c ****                     // FIX: interrupted when other key is pressed
 254:../../tmk_core/common/action_tapping.c ****                     tapping_key.tap.interrupted = true;
 255:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 256:../../tmk_core/common/action_tapping.c ****                     return true;
 257:../../tmk_core/common/action_tapping.c ****                 }
 258:../../tmk_core/common/action_tapping.c ****             } else {
 259:../../tmk_core/common/action_tapping.c ****                 if (!IS_NOEVENT(event)) debug("Tapping: other key just after tap.\n");
 260:../../tmk_core/common/action_tapping.c ****                 process_action(keyp);
 261:../../tmk_core/common/action_tapping.c ****                 return true;
 262:../../tmk_core/common/action_tapping.c ****             }
 263:../../tmk_core/common/action_tapping.c ****         } else {
 264:../../tmk_core/common/action_tapping.c ****             // FIX: process_aciton here?
 265:../../tmk_core/common/action_tapping.c ****             // timeout. no sequential tap.
 266:../../tmk_core/common/action_tapping.c ****             debug("Tapping: End(Timeout after releasing last tap): ");
 267:../../tmk_core/common/action_tapping.c ****             debug_event(event); debug("\n");
 268:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 269:../../tmk_core/common/action_tapping.c ****             debug_tapping_key();
 270:../../tmk_core/common/action_tapping.c ****             return false;
 271:../../tmk_core/common/action_tapping.c ****         }
 272:../../tmk_core/common/action_tapping.c ****     }
 273:../../tmk_core/common/action_tapping.c ****     // not tapping state
 274:../../tmk_core/common/action_tapping.c ****     else {
 275:../../tmk_core/common/action_tapping.c ****         if (event.pressed && is_tap_key(event)) {
 276:../../tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 277:../../tmk_core/common/action_tapping.c ****             tapping_key = *keyp;
 278:../../tmk_core/common/action_tapping.c ****             waiting_buffer_scan_tap();
 279:../../tmk_core/common/action_tapping.c ****             debug_tapping_key();
 280:../../tmk_core/common/action_tapping.c ****             return true;
 281:../../tmk_core/common/action_tapping.c ****         } else {
 282:../../tmk_core/common/action_tapping.c ****             process_action(keyp);
 283:../../tmk_core/common/action_tapping.c ****             return true;
 284:../../tmk_core/common/action_tapping.c ****         }
 285:../../tmk_core/common/action_tapping.c ****     }
 286:../../tmk_core/common/action_tapping.c **** }
 287:../../tmk_core/common/action_tapping.c **** 
 288:../../tmk_core/common/action_tapping.c **** 
 289:../../tmk_core/common/action_tapping.c **** /*
 290:../../tmk_core/common/action_tapping.c ****  * Waiting buffer
 291:../../tmk_core/common/action_tapping.c ****  */
 292:../../tmk_core/common/action_tapping.c **** bool waiting_buffer_enq(keyrecord_t record)
 293:../../tmk_core/common/action_tapping.c **** {
 294:../../tmk_core/common/action_tapping.c ****     if (IS_NOEVENT(record.event)) {
 295:../../tmk_core/common/action_tapping.c ****         return true;
 296:../../tmk_core/common/action_tapping.c ****     }
 297:../../tmk_core/common/action_tapping.c **** 
 298:../../tmk_core/common/action_tapping.c ****     if ((waiting_buffer_head + 1) % WAITING_BUFFER_SIZE == waiting_buffer_tail) {
 299:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 300:../../tmk_core/common/action_tapping.c ****         return false;
 301:../../tmk_core/common/action_tapping.c ****     }
 302:../../tmk_core/common/action_tapping.c **** 
 303:../../tmk_core/common/action_tapping.c ****     waiting_buffer[waiting_buffer_head] = record;
 304:../../tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 305:../../tmk_core/common/action_tapping.c **** 
 306:../../tmk_core/common/action_tapping.c ****     debug("waiting_buffer_enq: "); debug_waiting_buffer();
 307:../../tmk_core/common/action_tapping.c ****     return true;
 308:../../tmk_core/common/action_tapping.c **** }
 309:../../tmk_core/common/action_tapping.c **** 
 310:../../tmk_core/common/action_tapping.c **** void waiting_buffer_clear(void)
 311:../../tmk_core/common/action_tapping.c **** {
 312:../../tmk_core/common/action_tapping.c ****     waiting_buffer_head = 0;
 313:../../tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 314:../../tmk_core/common/action_tapping.c **** }
 315:../../tmk_core/common/action_tapping.c **** 
 316:../../tmk_core/common/action_tapping.c **** bool waiting_buffer_typed(keyevent_t event)
 317:../../tmk_core/common/action_tapping.c **** {
 318:../../tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 319:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 320:../../tmk_core/common/action_tapping.c ****             return true;
 321:../../tmk_core/common/action_tapping.c ****         }
 322:../../tmk_core/common/action_tapping.c ****     }
 323:../../tmk_core/common/action_tapping.c ****     return false;
 324:../../tmk_core/common/action_tapping.c **** }
 325:../../tmk_core/common/action_tapping.c **** 
 326:../../tmk_core/common/action_tapping.c **** /* scan buffer for tapping */
 327:../../tmk_core/common/action_tapping.c **** void waiting_buffer_scan_tap(void)
 328:../../tmk_core/common/action_tapping.c **** {
 329:../../tmk_core/common/action_tapping.c ****     // tapping already is settled
 330:../../tmk_core/common/action_tapping.c ****     if (tapping_key.tap.count > 0) return;
 331:../../tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 332:../../tmk_core/common/action_tapping.c ****     if (!tapping_key.event.pressed) return;
 333:../../tmk_core/common/action_tapping.c **** 
 334:../../tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 335:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 336:../../tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 337:../../tmk_core/common/action_tapping.c ****                 WITHIN_TAPPING_TERM(waiting_buffer[i].event)) {
 338:../../tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 339:../../tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 340:../../tmk_core/common/action_tapping.c ****             process_action(&tapping_key);
 341:../../tmk_core/common/action_tapping.c **** 
 342:../../tmk_core/common/action_tapping.c ****             debug("waiting_buffer_scan_tap: found at ["); debug_dec(i); debug("]\n");
 343:../../tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 344:../../tmk_core/common/action_tapping.c ****             return;
 345:../../tmk_core/common/action_tapping.c ****         }
 346:../../tmk_core/common/action_tapping.c ****     }
 347:../../tmk_core/common/action_tapping.c **** }
 348:../../tmk_core/common/action_tapping.c **** 
 349:../../tmk_core/common/action_tapping.c **** 
 350:../../tmk_core/common/action_tapping.c **** /*
 351:../../tmk_core/common/action_tapping.c ****  * debug print
 352:../../tmk_core/common/action_tapping.c ****  */
 353:../../tmk_core/common/action_tapping.c **** static void debug_tapping_key(void)
 354:../../tmk_core/common/action_tapping.c **** {
 355:../../tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY="); debug_record(tapping_key); debug("\n");
 356:../../tmk_core/common/action_tapping.c **** }
 357:../../tmk_core/common/action_tapping.c **** 
 358:../../tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void)
 359:../../tmk_core/common/action_tapping.c **** {
  15               		.loc 1 359 1 view -0
  16               		.cfi_startproc
  17 0000 CF93      		push r28
  18               	.LCFI0:
  19               		.cfi_def_cfa_offset 3
  20               		.cfi_offset 28, -2
  21 0002 DF93      		push r29
  22               	.LCFI1:
  23               		.cfi_def_cfa_offset 4
  24               		.cfi_offset 29, -3
  25               	/* prologue: function */
  26               	/* frame size = 0 */
  27               	/* stack size = 2 */
  28               	.L__stack_usage = 2
 360:../../tmk_core/common/action_tapping.c ****     debug("{ ");
  29               		.loc 1 360 5 view .LVU1
 361:../../tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  30               		.loc 1 361 5 view .LVU2
  31               	.LBB3:
  32               		.loc 1 361 10 view .LVU3
  33               		.loc 1 361 18 is_stmt 0 view .LVU4
  34 0004 C091 0000 		lds r28,waiting_buffer_tail
  35               	.LVL0:
  36               	.L2:
  37               		.loc 1 361 5 discriminator 1 view .LVU5
  38 0008 8091 0000 		lds r24,waiting_buffer_head
  39 000c 8C13      		cpse r24,r28
  40 000e 00C0      		rjmp .L3
  41               	/* epilogue start */
  42               	.LBE3:
 362:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
 363:../../tmk_core/common/action_tapping.c ****     }
 364:../../tmk_core/common/action_tapping.c ****     debug("}\n");
 365:../../tmk_core/common/action_tapping.c **** }
  43               		.loc 1 365 1 view .LVU6
  44 0010 DF91      		pop r29
  45 0012 CF91      		pop r28
  46               	.LVL1:
  47               		.loc 1 365 1 view .LVU7
  48 0014 0895      		ret
  49               	.LVL2:
  50               	.L3:
  51               	.LBB4:
 362:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  52               		.loc 1 362 9 is_stmt 1 discriminator 3 view .LVU8
 362:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  53               		.loc 1 362 21 discriminator 3 view .LVU9
 362:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  54               		.loc 1 362 35 discriminator 3 view .LVU10
 362:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  55               		.loc 1 362 48 discriminator 3 view .LVU11
  56 0016 D0E0      		ldi r29,0
  57 0018 CE01      		movw r24,r28
  58 001a 66E0      		ldi r22,lo8(6)
  59 001c 70E0      		ldi r23,0
  60 001e 0E94 0000 		call __mulhi3
  61 0022 FC01      		movw r30,r24
  62 0024 E050      		subi r30,lo8(-(waiting_buffer))
  63 0026 F040      		sbci r31,hi8(-(waiting_buffer))
  64 0028 4081      		ld r20,Z
  65 002a 5181      		ldd r21,Z+1
  66 002c 6281      		ldd r22,Z+2
  67 002e 7381      		ldd r23,Z+3
  68 0030 8481      		ldd r24,Z+4
  69 0032 9581      		ldd r25,Z+5
  70 0034 0E94 0000 		call debug_record
  71               	.LVL3:
 362:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  72               		.loc 1 362 81 discriminator 3 view .LVU12
 361:../../tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  73               		.loc 1 361 76 is_stmt 0 discriminator 3 view .LVU13
  74 0038 2196      		adiw r28,1
  75               	.LVL4:
 361:../../tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  76               		.loc 1 361 71 discriminator 3 view .LVU14
  77 003a C770      		andi r28,lo8(7)
 361:../../tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  78               		.loc 1 361 71 discriminator 3 view .LVU15
  79 003c 00C0      		rjmp .L2
  80               	.LBE4:
  81               		.cfi_endproc
  82               	.LFE11:
  84               		.section	.text.debug_tapping_key,"ax",@progbits
  86               	debug_tapping_key:
  87               	.LFB10:
 354:../../tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY="); debug_record(tapping_key); debug("\n");
  88               		.loc 1 354 1 is_stmt 1 view -0
  89               		.cfi_startproc
  90               	/* prologue: function */
  91               	/* frame size = 0 */
  92               	/* stack size = 0 */
  93               	.L__stack_usage = 0
 355:../../tmk_core/common/action_tapping.c **** }
  94               		.loc 1 355 5 view .LVU17
 355:../../tmk_core/common/action_tapping.c **** }
  95               		.loc 1 355 28 view .LVU18
  96 0000 4091 0000 		lds r20,tapping_key
  97 0004 5091 0000 		lds r21,tapping_key+1
  98 0008 6091 0000 		lds r22,tapping_key+2
  99 000c 7091 0000 		lds r23,tapping_key+3
 100 0010 8091 0000 		lds r24,tapping_key+4
 101 0014 9091 0000 		lds r25,tapping_key+5
 102 0018 0C94 0000 		jmp debug_record
 103               	.LVL5:
 104               		.cfi_endproc
 105               	.LFE10:
 107               		.section	.text.waiting_buffer_scan_tap,"ax",@progbits
 109               	waiting_buffer_scan_tap:
 110               	.LFB9:
 328:../../tmk_core/common/action_tapping.c ****     // tapping already is settled
 111               		.loc 1 328 1 view -0
 112               		.cfi_startproc
 113 0000 FF92      		push r15
 114               	.LCFI2:
 115               		.cfi_def_cfa_offset 3
 116               		.cfi_offset 15, -2
 117 0002 0F93      		push r16
 118               	.LCFI3:
 119               		.cfi_def_cfa_offset 4
 120               		.cfi_offset 16, -3
 121 0004 1F93      		push r17
 122               	.LCFI4:
 123               		.cfi_def_cfa_offset 5
 124               		.cfi_offset 17, -4
 125 0006 CF93      		push r28
 126               	.LCFI5:
 127               		.cfi_def_cfa_offset 6
 128               		.cfi_offset 28, -5
 129 0008 DF93      		push r29
 130               	.LCFI6:
 131               		.cfi_def_cfa_offset 7
 132               		.cfi_offset 29, -6
 133               	/* prologue: function */
 134               	/* frame size = 0 */
 135               	/* stack size = 5 */
 136               	.L__stack_usage = 5
 330:../../tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 137               		.loc 1 330 5 view .LVU20
 330:../../tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 138               		.loc 1 330 31 is_stmt 0 view .LVU21
 139 000a 8091 0000 		lds r24,tapping_key+5
 140 000e 807F      		andi r24,lo8(-16)
 330:../../tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 141               		.loc 1 330 8 view .LVU22
 142 0010 01F4      		brne .L5
 332:../../tmk_core/common/action_tapping.c **** 
 143               		.loc 1 332 5 is_stmt 1 view .LVU23
 332:../../tmk_core/common/action_tapping.c **** 
 144               		.loc 1 332 8 is_stmt 0 view .LVU24
 145 0012 8091 0000 		lds r24,tapping_key+2
 146 0016 8823      		tst r24
 147 0018 01F0      		breq .L5
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 148               		.loc 1 334 5 is_stmt 1 view .LVU25
 149               	.LBB8:
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 150               		.loc 1 334 10 view .LVU26
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 151               		.loc 1 334 18 is_stmt 0 view .LVU27
 152 001a 2091 0000 		lds r18,waiting_buffer_tail
 153               	.LVL6:
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 154               		.loc 1 334 45 view .LVU28
 155 001e 0091 0000 		lds r16,waiting_buffer_head
 335:../../tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 156               		.loc 1 335 13 view .LVU29
 157 0022 4091 0000 		lds r20,tapping_key
 158 0026 1091 0000 		lds r17,tapping_key+1
 159 002a A091 0000 		lds r26,tapping_key+3
 160 002e B091 0000 		lds r27,tapping_key+3+1
 161 0032 F42E      		mov r15,r20
 162 0034 F122      		and r15,r17
 163 0036 ED01      		movw r28,r26
 164 0038 C095      		com r28
 165 003a D095      		com r29
 166               	.LVL7:
 167               	.L7:
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 168               		.loc 1 334 5 discriminator 1 view .LVU30
 169 003c 0213      		cpse r16,r18
 170 003e 00C0      		rjmp .L14
 171               	.LVL8:
 172               	.L5:
 173               	/* epilogue start */
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 174               		.loc 1 334 5 discriminator 1 view .LVU31
 175               	.LBE8:
 347:../../tmk_core/common/action_tapping.c **** 
 176               		.loc 1 347 1 view .LVU32
 177 0040 DF91      		pop r29
 178 0042 CF91      		pop r28
 179 0044 1F91      		pop r17
 180 0046 0F91      		pop r16
 181 0048 FF90      		pop r15
 182 004a 0895      		ret
 183               	.LVL9:
 184               	.L14:
 185               	.LBB11:
 335:../../tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 186               		.loc 1 335 9 is_stmt 1 view .LVU33
 187               	.LBB9:
 188               	.LBI9:
 189               		.file 2 "../../tmk_core/common/keyboard.h"
   1:../../tmk_core/common/keyboard.h **** /*
   2:../../tmk_core/common/keyboard.h **** Copyright 2011,2012,2013 Jun Wako <wakojun@gmail.com>
   3:../../tmk_core/common/keyboard.h **** 
   4:../../tmk_core/common/keyboard.h **** This program is free software: you can redistribute it and/or modify
   5:../../tmk_core/common/keyboard.h **** it under the terms of the GNU General Public License as published by
   6:../../tmk_core/common/keyboard.h **** the Free Software Foundation, either version 2 of the License, or
   7:../../tmk_core/common/keyboard.h **** (at your option) any later version.
   8:../../tmk_core/common/keyboard.h **** 
   9:../../tmk_core/common/keyboard.h **** This program is distributed in the hope that it will be useful,
  10:../../tmk_core/common/keyboard.h **** but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:../../tmk_core/common/keyboard.h **** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:../../tmk_core/common/keyboard.h **** GNU General Public License for more details.
  13:../../tmk_core/common/keyboard.h **** 
  14:../../tmk_core/common/keyboard.h **** You should have received a copy of the GNU General Public License
  15:../../tmk_core/common/keyboard.h **** along with this program.  If not, see <http://www.gnu.org/licenses/>.
  16:../../tmk_core/common/keyboard.h **** */
  17:../../tmk_core/common/keyboard.h **** 
  18:../../tmk_core/common/keyboard.h **** #ifndef KEYBOARD_H
  19:../../tmk_core/common/keyboard.h **** #define KEYBOARD_H
  20:../../tmk_core/common/keyboard.h **** 
  21:../../tmk_core/common/keyboard.h **** #include <stdbool.h>
  22:../../tmk_core/common/keyboard.h **** #include <stdint.h>
  23:../../tmk_core/common/keyboard.h **** 
  24:../../tmk_core/common/keyboard.h **** 
  25:../../tmk_core/common/keyboard.h **** #ifdef __cplusplus
  26:../../tmk_core/common/keyboard.h **** extern "C" {
  27:../../tmk_core/common/keyboard.h **** #endif
  28:../../tmk_core/common/keyboard.h **** 
  29:../../tmk_core/common/keyboard.h **** /* key matrix position */
  30:../../tmk_core/common/keyboard.h **** typedef struct {
  31:../../tmk_core/common/keyboard.h ****     uint8_t col;
  32:../../tmk_core/common/keyboard.h ****     uint8_t row;
  33:../../tmk_core/common/keyboard.h **** } keypos_t;
  34:../../tmk_core/common/keyboard.h **** 
  35:../../tmk_core/common/keyboard.h **** /* key event */
  36:../../tmk_core/common/keyboard.h **** typedef struct {
  37:../../tmk_core/common/keyboard.h ****     keypos_t key;
  38:../../tmk_core/common/keyboard.h ****     bool     pressed;
  39:../../tmk_core/common/keyboard.h ****     uint16_t time;
  40:../../tmk_core/common/keyboard.h **** } keyevent_t;
  41:../../tmk_core/common/keyboard.h **** 
  42:../../tmk_core/common/keyboard.h **** /* equivalent test of keypos_t */
  43:../../tmk_core/common/keyboard.h **** #define KEYEQ(keya, keyb)       ((keya).row == (keyb).row && (keya).col == (keyb).col)
  44:../../tmk_core/common/keyboard.h **** 
  45:../../tmk_core/common/keyboard.h **** /* Rules for No Event:
  46:../../tmk_core/common/keyboard.h ****  * 1) (time == 0) to handle (keyevent_t){} as empty event
  47:../../tmk_core/common/keyboard.h ****  * 2) Matrix(255, 255) to make TICK event available
  48:../../tmk_core/common/keyboard.h ****  */
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_NOEVENT(keyevent_t event) { return event.time == 0 || (event.key.row == 255 &
 190               		.loc 2 49 20 view .LVU34
 191               	.LBB10:
 192               		.loc 2 49 51 view .LVU35
 193 004c 30E0      		ldi r19,0
 194               		.loc 2 49 74 is_stmt 0 view .LVU36
 195 004e 1097      		sbiw r26,0
 196 0050 01F0      		breq .L8
 197 0052 8FEF      		ldi r24,lo8(-1)
 198 0054 F812      		cpse r15,r24
 199 0056 00C0      		rjmp .L27
 200               	.L8:
 201               	.LBE10:
 202               	.LBE9:
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 203               		.loc 1 334 76 discriminator 2 view .LVU37
 204 0058 2F5F      		subi r18,-1
 205 005a 3F4F      		sbci r19,-1
 206               	.LVL10:
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 207               		.loc 1 334 71 discriminator 2 view .LVU38
 208 005c 2770      		andi r18,lo8(7)
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 209               		.loc 1 334 71 discriminator 2 view .LVU39
 210 005e 00C0      		rjmp .L7
 211               	.LVL11:
 212               	.L10:
 337:../../tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 213               		.loc 1 337 17 discriminator 2 view .LVU40
 214 0060 8C0F      		add r24,r28
 215 0062 9D1F      		adc r25,r29
 216 0064 00C0      		rjmp .L28
 217               	.L27:
 335:../../tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 218               		.loc 1 335 13 view .LVU41
 219 0066 C901      		movw r24,r18
 220 0068 66E0      		ldi r22,lo8(6)
 221 006a 70E0      		ldi r23,0
 222 006c 0E94 0000 		call __mulhi3
 223 0070 FC01      		movw r30,r24
 224 0072 E050      		subi r30,lo8(-(waiting_buffer))
 225 0074 F040      		sbci r31,hi8(-(waiting_buffer))
 226 0076 8181      		ldd r24,Z+1
 227 0078 8113      		cpse r24,r17
 228 007a 00C0      		rjmp .L8
 335:../../tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 229               		.loc 1 335 13 discriminator 2 view .LVU42
 230 007c 8081      		ld r24,Z
 231 007e 8413      		cpse r24,r20
 232 0080 00C0      		rjmp .L8
 335:../../tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 233               		.loc 1 335 57 discriminator 3 view .LVU43
 234 0082 8281      		ldd r24,Z+2
 235 0084 8111      		cpse r24,__zero_reg__
 236 0086 00C0      		rjmp .L8
 337:../../tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 237               		.loc 1 337 17 view .LVU44
 238 0088 8381      		ldd r24,Z+3
 239 008a 9481      		ldd r25,Z+4
 240 008c 8A17      		cp r24,r26
 241 008e 9B07      		cpc r25,r27
 242 0090 00F0      		brlo .L10
 337:../../tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 243               		.loc 1 337 17 discriminator 1 view .LVU45
 244 0092 8A1B      		sub r24,r26
 245 0094 9B0B      		sbc r25,r27
 246               	.L28:
 337:../../tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 247               		.loc 1 337 17 discriminator 2 view .LVU46
 248 0096 883C      		cpi r24,-56
 249 0098 9105      		cpc r25,__zero_reg__
 250 009a 00F4      		brsh .L8
 338:../../tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 251               		.loc 1 338 13 is_stmt 1 view .LVU47
 338:../../tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 252               		.loc 1 338 35 is_stmt 0 view .LVU48
 253 009c 8091 0000 		lds r24,tapping_key+5
 254 00a0 8F70      		andi r24,lo8(15)
 255 00a2 8061      		ori r24,lo8(16)
 256 00a4 8093 0000 		sts tapping_key+5,r24
 339:../../tmk_core/common/action_tapping.c ****             process_action(&tapping_key);
 257               		.loc 1 339 13 is_stmt 1 view .LVU49
 339:../../tmk_core/common/action_tapping.c ****             process_action(&tapping_key);
 258               		.loc 1 339 41 is_stmt 0 view .LVU50
 259 00a8 C901      		movw r24,r18
 260 00aa 66E0      		ldi r22,lo8(6)
 261 00ac 70E0      		ldi r23,0
 262 00ae 0E94 0000 		call __mulhi3
 263 00b2 FC01      		movw r30,r24
 264 00b4 E050      		subi r30,lo8(-(waiting_buffer+5))
 265 00b6 F040      		sbci r31,hi8(-(waiting_buffer+5))
 266 00b8 9081      		ld r25,Z
 267 00ba 9F70      		andi r25,lo8(15)
 268 00bc 9061      		ori r25,lo8(16)
 269 00be 9083      		st Z,r25
 340:../../tmk_core/common/action_tapping.c **** 
 270               		.loc 1 340 13 is_stmt 1 view .LVU51
 271 00c0 80E0      		ldi r24,lo8(tapping_key)
 272 00c2 90E0      		ldi r25,hi8(tapping_key)
 273 00c4 0E94 0000 		call process_action
 274               	.LVL12:
 342:../../tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 275               		.loc 1 342 13 view .LVU52
 342:../../tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 276               		.loc 1 342 59 view .LVU53
 342:../../tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 277               		.loc 1 342 73 view .LVU54
 343:../../tmk_core/common/action_tapping.c ****             return;
 278               		.loc 1 343 13 view .LVU55
 279               	/* epilogue start */
 280               	.LBE11:
 347:../../tmk_core/common/action_tapping.c **** 
 281               		.loc 1 347 1 is_stmt 0 view .LVU56
 282 00c8 DF91      		pop r29
 283 00ca CF91      		pop r28
 284 00cc 1F91      		pop r17
 285 00ce 0F91      		pop r16
 286 00d0 FF90      		pop r15
 287               	.LBB12:
 343:../../tmk_core/common/action_tapping.c ****             return;
 288               		.loc 1 343 13 view .LVU57
 289 00d2 0C94 0000 		jmp debug_waiting_buffer
 290               	.LVL13:
 291               	.LBE12:
 292               		.cfi_endproc
 293               	.LFE9:
 295               		.section	.text.process_tapping,"ax",@progbits
 297               	process_tapping:
 298               	.LVL14:
 299               	.LFB5:
  79:../../tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 300               		.loc 1 79 1 is_stmt 1 view -0
 301               		.cfi_startproc
  79:../../tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 302               		.loc 1 79 1 is_stmt 0 view .LVU59
 303 0000 9F92      		push r9
 304               	.LCFI7:
 305               		.cfi_def_cfa_offset 3
 306               		.cfi_offset 9, -2
 307 0002 AF92      		push r10
 308               	.LCFI8:
 309               		.cfi_def_cfa_offset 4
 310               		.cfi_offset 10, -3
 311 0004 BF92      		push r11
 312               	.LCFI9:
 313               		.cfi_def_cfa_offset 5
 314               		.cfi_offset 11, -4
 315 0006 CF92      		push r12
 316               	.LCFI10:
 317               		.cfi_def_cfa_offset 6
 318               		.cfi_offset 12, -5
 319 0008 DF92      		push r13
 320               	.LCFI11:
 321               		.cfi_def_cfa_offset 7
 322               		.cfi_offset 13, -6
 323 000a EF92      		push r14
 324               	.LCFI12:
 325               		.cfi_def_cfa_offset 8
 326               		.cfi_offset 14, -7
 327 000c FF92      		push r15
 328               	.LCFI13:
 329               		.cfi_def_cfa_offset 9
 330               		.cfi_offset 15, -8
 331 000e 0F93      		push r16
 332               	.LCFI14:
 333               		.cfi_def_cfa_offset 10
 334               		.cfi_offset 16, -9
 335 0010 1F93      		push r17
 336               	.LCFI15:
 337               		.cfi_def_cfa_offset 11
 338               		.cfi_offset 17, -10
 339 0012 CF93      		push r28
 340               	.LCFI16:
 341               		.cfi_def_cfa_offset 12
 342               		.cfi_offset 28, -11
 343 0014 DF93      		push r29
 344               	.LCFI17:
 345               		.cfi_def_cfa_offset 13
 346               		.cfi_offset 29, -12
 347 0016 CDB7      		in r28,__SP_L__
 348 0018 DEB7      		in r29,__SP_H__
 349               	.LCFI18:
 350               		.cfi_def_cfa_register 28
 351 001a 2B97      		sbiw r28,11
 352               	.LCFI19:
 353               		.cfi_def_cfa_offset 24
 354 001c 0FB6      		in __tmp_reg__,__SREG__
 355 001e F894      		cli
 356 0020 DEBF      		out __SP_H__,r29
 357 0022 0FBE      		out __SREG__,__tmp_reg__
 358 0024 CDBF      		out __SP_L__,r28
 359               	/* prologue: function */
 360               	/* frame size = 11 */
 361               	/* stack size = 22 */
 362               	.L__stack_usage = 22
 363 0026 7C01      		movw r14,r24
  80:../../tmk_core/common/action_tapping.c **** 
 364               		.loc 1 80 5 is_stmt 1 view .LVU60
  80:../../tmk_core/common/action_tapping.c **** 
 365               		.loc 1 80 16 is_stmt 0 view .LVU61
 366 0028 85E0      		ldi r24,lo8(5)
 367               	.LVL15:
  80:../../tmk_core/common/action_tapping.c **** 
 368               		.loc 1 80 16 view .LVU62
 369 002a F701      		movw r30,r14
 370 002c DE01      		movw r26,r28
 371 002e 1796      		adiw r26,7
 372               		0:
 373 0030 0190      		ld r0,Z+
 374 0032 0D92      		st X+,r0
 375 0034 8A95      		dec r24
 376 0036 01F4      		brne 0b
 377 0038 D701      		movw r26,r14
 378 003a 4C91      		ld r20,X
 379               	.LVL16:
  80:../../tmk_core/common/action_tapping.c **** 
 380               		.loc 1 80 16 view .LVU63
 381 003c 1196      		adiw r26,1
 382 003e 2C91      		ld r18,X
 383 0040 1197      		sbiw r26,1
 384               	.LVL17:
  80:../../tmk_core/common/action_tapping.c **** 
 385               		.loc 1 80 16 view .LVU64
 386 0042 1296      		adiw r26,2
 387 0044 DC90      		ld r13,X
 388 0046 1297      		sbiw r26,2
 389               	.LVL18:
  80:../../tmk_core/common/action_tapping.c **** 
 390               		.loc 1 80 16 view .LVU65
 391 0048 1396      		adiw r26,3
 392 004a 0D91      		ld r16,X+
 393 004c 1C91      		ld r17,X
 394               	.LVL19:
  83:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 395               		.loc 1 83 5 is_stmt 1 view .LVU66
  83:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 396               		.loc 1 83 9 is_stmt 0 view .LVU67
 397 004e 8091 0000 		lds r24,tapping_key+3
 398 0052 9091 0000 		lds r25,tapping_key+3+1
 399               	.LBB28:
 400               	.LBI28:
 401               		.loc 2 49 20 is_stmt 1 view .LVU68
 402               	.LBB29:
 403               		.loc 2 49 51 view .LVU69
 404               		.loc 2 49 74 is_stmt 0 view .LVU70
 405 0056 0097      		sbiw r24,0
 406 0058 01F4      		brne .+2
 407 005a 00C0      		rjmp .L30
 408               	.LBE29:
 409               	.LBE28:
  83:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 410               		.loc 1 83 9 view .LVU71
 411 005c 3091 0000 		lds r19,tapping_key
 412 0060 5091 0000 		lds r21,tapping_key+1
 413               	.LBB31:
 414               	.LBB30:
 415               		.loc 2 49 74 view .LVU72
 416 0064 652F      		mov r22,r21
 417 0066 6323      		and r22,r19
 418 0068 6F3F      		cpi r22,lo8(-1)
 419 006a 01F4      		brne .+2
 420 006c 00C0      		rjmp .L30
 421               	.LBE30:
 422               	.LBE31:
  83:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 423               		.loc 1 83 9 discriminator 1 view .LVU73
 424 006e 9090 0000 		lds r9,tapping_key+2
 425 0072 9920      		tst r9
 426 0074 01F4      		brne .+2
 427 0076 00C0      		rjmp .L31
  84:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 428               		.loc 1 84 9 is_stmt 1 view .LVU74
  84:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 429               		.loc 1 84 13 is_stmt 0 view .LVU75
 430 0078 0817      		cp r16,r24
 431 007a 1907      		cpc r17,r25
 432 007c 00F4      		brsh .+2
 433 007e 00C0      		rjmp .L32
  84:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 434               		.loc 1 84 13 discriminator 1 view .LVU76
 435 0080 F801      		movw r30,r16
 436 0082 E81B      		sub r30,r24
 437 0084 F90B      		sbc r31,r25
 438 0086 CF01      		movw r24,r30
 439               	.L120:
  84:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 440               		.loc 1 84 13 discriminator 2 view .LVU77
 441 0088 CC24      		clr r12
 442 008a C394      		inc r12
 443 008c 883C      		cpi r24,-56
 444 008e 9105      		cpc r25,__zero_reg__
 445 0090 00F0      		brlo .L34
 446 0092 C12C      		mov r12,__zero_reg__
 447               	.L34:
 448 0094 80E0      		ldi r24,lo8(tapping_key)
 449 0096 A82E      		mov r10,r24
 450 0098 80E0      		ldi r24,hi8(tapping_key)
 451 009a B82E      		mov r11,r24
 452 009c 8091 0000 		lds r24,tapping_key+5
 453 00a0 982F      		mov r25,r24
 454 00a2 907F      		andi r25,lo8(-16)
  84:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 455               		.loc 1 84 12 discriminator 4 view .LVU78
 456 00a4 CC20      		tst r12
 457 00a6 01F4      		brne .+2
 458 00a8 00C0      		rjmp .L36
  85:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 459               		.loc 1 85 13 is_stmt 1 view .LVU79
  85:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 460               		.loc 1 85 16 is_stmt 0 view .LVU80
 461 00aa 9111      		cpse r25,__zero_reg__
 462 00ac 00C0      		rjmp .L37
  86:../../tmk_core/common/action_tapping.c ****                     // first tap!
 463               		.loc 1 86 17 is_stmt 1 discriminator 1 view .LVU81
 464 00ae CD2C      		mov r12,r13
  86:../../tmk_core/common/action_tapping.c ****                     // first tap!
 465               		.loc 1 86 21 is_stmt 0 discriminator 1 view .LVU82
 466 00b0 5213      		cpse r21,r18
 467 00b2 00C0      		rjmp .L38
 468               	.LVL20:
  86:../../tmk_core/common/action_tapping.c ****                     // first tap!
 469               		.loc 1 86 21 discriminator 2 view .LVU83
 470 00b4 3413      		cpse r19,r20
 471 00b6 00C0      		rjmp .L38
  86:../../tmk_core/common/action_tapping.c ****                     // first tap!
 472               		.loc 1 86 47 discriminator 3 view .LVU84
 473 00b8 D110      		cpse r13,__zero_reg__
 474 00ba 00C0      		rjmp .L38
  88:../../tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
 475               		.loc 1 88 21 is_stmt 1 view .LVU85
  89:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 476               		.loc 1 89 21 view .LVU86
  89:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 477               		.loc 1 89 43 is_stmt 0 view .LVU87
 478 00bc 8F70      		andi r24,lo8(15)
 479 00be 8061      		ori r24,lo8(16)
 480 00c0 8093 0000 		sts tapping_key+5,r24
  90:../../tmk_core/common/action_tapping.c ****                     process_action(&tapping_key);
 481               		.loc 1 90 21 is_stmt 1 view .LVU88
 482 00c4 0E94 0000 		call debug_tapping_key
 483               	.LVL21:
  91:../../tmk_core/common/action_tapping.c **** 
 484               		.loc 1 91 21 view .LVU89
 485 00c8 C501      		movw r24,r10
 486 00ca 0E94 0000 		call process_action
 487               	.LVL22:
  94:../../tmk_core/common/action_tapping.c ****                     // enqueue
 488               		.loc 1 94 21 view .LVU90
  94:../../tmk_core/common/action_tapping.c ****                     // enqueue
 489               		.loc 1 94 31 is_stmt 0 view .LVU91
 490 00ce 8091 0000 		lds r24,tapping_key+5
 491 00d2 D701      		movw r26,r14
 492 00d4 1596      		adiw r26,5
 493 00d6 8C93      		st X,r24
  96:../../tmk_core/common/action_tapping.c ****                 }
 494               		.loc 1 96 21 is_stmt 1 view .LVU92
 495               	.LVL23:
 496               	.L29:
 286:../../tmk_core/common/action_tapping.c **** 
 497               		.loc 1 286 1 is_stmt 0 view .LVU93
 498 00d8 8C2D      		mov r24,r12
 499               	/* epilogue start */
 286:../../tmk_core/common/action_tapping.c **** 
 500               		.loc 1 286 1 view .LVU94
 501 00da 2B96      		adiw r28,11
 502 00dc 0FB6      		in __tmp_reg__,__SREG__
 503 00de F894      		cli
 504 00e0 DEBF      		out __SP_H__,r29
 505 00e2 0FBE      		out __SREG__,__tmp_reg__
 506 00e4 CDBF      		out __SP_L__,r28
 507 00e6 DF91      		pop r29
 508 00e8 CF91      		pop r28
 509 00ea 1F91      		pop r17
 510 00ec 0F91      		pop r16
 511               	.LVL24:
 286:../../tmk_core/common/action_tapping.c **** 
 512               		.loc 1 286 1 view .LVU95
 513 00ee FF90      		pop r15
 514 00f0 EF90      		pop r14
 515               	.LVL25:
 286:../../tmk_core/common/action_tapping.c **** 
 516               		.loc 1 286 1 view .LVU96
 517 00f2 DF90      		pop r13
 518               	.LVL26:
 286:../../tmk_core/common/action_tapping.c **** 
 519               		.loc 1 286 1 view .LVU97
 520 00f4 CF90      		pop r12
 521 00f6 BF90      		pop r11
 522 00f8 AF90      		pop r10
 523 00fa 9F90      		pop r9
 524 00fc 0895      		ret
 525               	.LVL27:
 526               	.L32:
  84:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 527               		.loc 1 84 13 discriminator 2 view .LVU98
 528 00fe 8095      		com r24
 529 0100 9095      		com r25
 530 0102 800F      		add r24,r16
 531 0104 911F      		adc r25,r17
 532 0106 00C0      		rjmp .L120
 533               	.LVL28:
 534               	.L38:
 116:../../tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 535               		.loc 1 116 22 is_stmt 1 view .LVU99
 536               	.LBB32:
 537               	.LBI32:
  50:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
  51:../../tmk_core/common/keyboard.h **** static inline bool IS_RELEASED(keyevent_t event) { return (!IS_NOEVENT(event) && !event.pressed); }
 538               		.loc 2 51 20 view .LVU100
 539               	.LBB33:
 540               		.loc 2 51 52 view .LVU101
 541               	.LBB34:
 542               	.LBI34:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 543               		.loc 2 49 20 view .LVU102
 544               	.LBB35:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 545               		.loc 2 49 51 view .LVU103
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 546               		.loc 2 49 74 is_stmt 0 view .LVU104
 547 0108 0115      		cp r16,__zero_reg__
 548 010a 1105      		cpc r17,__zero_reg__
 549 010c 01F0      		breq .L69
 550 010e 842F      		mov r24,r20
 551 0110 8223      		and r24,r18
 552 0112 8F3F      		cpi r24,lo8(-1)
 553 0114 01F0      		breq .+2
 554 0116 00C0      		rjmp .L41
 555               	.L69:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 556               		.loc 2 49 74 view .LVU105
 557               	.LBE35:
 558               	.LBE34:
 559               		.loc 2 51 79 view .LVU106
 560 0118 80E0      		ldi r24,0
 561               	.L40:
 562               	.LVL29:
 563               		.loc 2 51 79 view .LVU107
 564               	.LBE33:
 565               	.LBE32:
 116:../../tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 566               		.loc 1 116 25 view .LVU108
 567 011a B82F      		mov r27,r24
 568 011c B170      		andi r27,lo8(1)
 569 011e BB2E      		mov r11,r27
 570               	.LBB37:
 571               	.LBB38:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 572               		.loc 1 318 18 view .LVU109
 573 0120 E091 0000 		lds r30,waiting_buffer_tail
 574               	.LVL30:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 575               		.loc 1 318 45 view .LVU110
 576 0124 3091 0000 		lds r19,waiting_buffer_head
 577               	.LBE38:
 578               	.LBE37:
 116:../../tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 579               		.loc 1 116 25 view .LVU111
 580 0128 80FD      		sbrc r24,0
 581 012a 00C0      		rjmp .L43
 582               	.L42:
 583               	.LVL31:
 138:../../tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 584               		.loc 1 138 21 is_stmt 1 view .LVU112
 138:../../tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 585               		.loc 1 138 24 is_stmt 0 view .LVU113
 586 012c DD20      		tst r13
 587 012e 01F0      		breq .L29
 139:../../tmk_core/common/action_tapping.c ****                     }
 588               		.loc 1 139 25 is_stmt 1 view .LVU114
 139:../../tmk_core/common/action_tapping.c ****                     }
 589               		.loc 1 139 53 is_stmt 0 view .LVU115
 590 0130 8091 0000 		lds r24,tapping_key+5
 591 0134 8160      		ori r24,lo8(1<<0)
 592 0136 8093 0000 		sts tapping_key+5,r24
 142:../../tmk_core/common/action_tapping.c ****                 }
 593               		.loc 1 142 28 view .LVU116
 594 013a C12C      		mov r12,__zero_reg__
 595               	.LVL32:
 142:../../tmk_core/common/action_tapping.c ****                 }
 596               		.loc 1 142 28 view .LVU117
 597 013c 00C0      		rjmp .L29
 598               	.LVL33:
 599               	.L45:
 600               	.LBB40:
 601               	.LBB39:
 319:../../tmk_core/common/action_tapping.c ****             return true;
 602               		.loc 1 319 9 is_stmt 1 view .LVU118
 319:../../tmk_core/common/action_tapping.c ****             return true;
 603               		.loc 1 319 13 is_stmt 0 view .LVU119
 604 013e F0E0      		ldi r31,0
 605 0140 CF01      		movw r24,r30
 606 0142 66E0      		ldi r22,lo8(6)
 607 0144 70E0      		ldi r23,0
 608 0146 0E94 0000 		call __mulhi3
 609 014a DC01      		movw r26,r24
 610 014c A050      		subi r26,lo8(-(waiting_buffer))
 611 014e B040      		sbci r27,hi8(-(waiting_buffer))
 319:../../tmk_core/common/action_tapping.c ****             return true;
 612               		.loc 1 319 12 view .LVU120
 613 0150 1196      		adiw r26,1
 614 0152 8C91      		ld r24,X
 615 0154 1197      		sbiw r26,1
 616 0156 8213      		cpse r24,r18
 617 0158 00C0      		rjmp .L44
 319:../../tmk_core/common/action_tapping.c ****             return true;
 618               		.loc 1 319 13 view .LVU121
 619 015a 8C91      		ld r24,X
 620 015c 8413      		cpse r24,r20
 621 015e 00C0      		rjmp .L44
 319:../../tmk_core/common/action_tapping.c ****             return true;
 622               		.loc 1 319 59 view .LVU122
 623 0160 1296      		adiw r26,2
 624 0162 8C91      		ld r24,X
 625 0164 8D11      		cpse r24,r13
 626 0166 00C0      		rjmp .L42
 627               	.L44:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 628               		.loc 1 318 76 view .LVU123
 629 0168 3196      		adiw r30,1
 630               	.LVL34:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 631               		.loc 1 318 71 view .LVU124
 632 016a E770      		andi r30,lo8(7)
 633               	.L43:
 634               	.LVL35:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 635               		.loc 1 318 5 view .LVU125
 636 016c E313      		cpse r30,r19
 637 016e 00C0      		rjmp .L45
 638               	.LVL36:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 639               		.loc 1 318 5 view .LVU126
 640               	.LBE39:
 641               	.LBE40:
 642               	.LBB41:
 118:../../tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 643               		.loc 1 118 21 is_stmt 1 view .LVU127
 118:../../tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 644               		.loc 1 118 39 is_stmt 0 view .LVU128
 645 0170 702F      		mov r23,r16
 646 0172 1B87      		std Y+11,r17
 647 0174 0A87      		std Y+10,r16
 648 0176 522F      		mov r21,r18
 649 0178 6D2D      		mov r22,r13
 650 017a 8B85      		ldd r24,Y+11
 651 017c 0E94 0000 		call layer_switch_get_action
 652               	.LVL37:
 119:../../tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 653               		.loc 1 119 21 is_stmt 1 view .LVU129
 119:../../tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 654               		.loc 1 119 40 is_stmt 0 view .LVU130
 655 0180 292F      		mov r18,r25
 656 0182 2295      		swap r18
 657 0184 2F70      		andi r18,lo8(15)
 119:../../tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 658               		.loc 1 119 21 view .LVU131
 659 0186 9032      		cpi r25,lo8(32)
 660 0188 00F0      		brlo .L67
 119:../../tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 661               		.loc 1 119 21 view .LVU132
 662 018a 225F      		subi r18,lo8(-(14))
 663 018c 2F70      		andi r18,lo8(15)
 664 018e 2230      		cpi r18,lo8(2)
 665 0190 00F4      		brsh .L49
 127:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 666               		.loc 1 127 29 is_stmt 1 view .LVU133
 127:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 667               		.loc 1 127 33 is_stmt 0 view .LVU134
 668 0192 9F70      		andi r25,lo8(15)
 669               	.LVL38:
 127:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 670               		.loc 1 127 32 view .LVU135
 671 0194 01F0      		breq .L50
 127:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 672               		.loc 1 127 68 discriminator 1 view .LVU136
 673 0196 F701      		movw r30,r14
 674 0198 9581      		ldd r25,Z+5
 675 019a 907F      		andi r25,lo8(-16)
 127:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 676               		.loc 1 127 49 discriminator 1 view .LVU137
 677 019c 01F4      		brne .L50
 678               	.LVL39:
 679               	.L73:
 122:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 680               		.loc 1 122 77 view .LVU138
 681 019e B12C      		mov r11,__zero_reg__
 682 01a0 00C0      		rjmp .L48
 683               	.LVL40:
 684               	.L67:
 122:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 685               		.loc 1 122 29 is_stmt 1 view .LVU139
 122:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 686               		.loc 1 122 33 is_stmt 0 view .LVU140
 687 01a2 9F70      		andi r25,lo8(15)
 688               	.LVL41:
 122:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 689               		.loc 1 122 32 view .LVU141
 690 01a4 01F0      		breq .L50
 122:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 691               		.loc 1 122 49 discriminator 1 view .LVU142
 692 01a6 8823      		tst r24
 693 01a8 01F0      		breq .L73
 694               	.L50:
 128:../../tmk_core/common/action_tapping.c ****                             break;
 695               		.loc 1 128 29 is_stmt 1 view .LVU143
 128:../../tmk_core/common/action_tapping.c ****                             break;
 696               		.loc 1 128 33 is_stmt 0 view .LVU144
 697 01aa 805E      		subi r24,lo8(-(32))
 698               	.LVL42:
 128:../../tmk_core/common/action_tapping.c ****                             break;
 699               		.loc 1 128 32 view .LVU145
 700 01ac 8830      		cpi r24,lo8(8)
 701 01ae 00F0      		brlo .L73
 702               	.LVL43:
 703               	.L49:
 132:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 704               		.loc 1 132 21 is_stmt 1 view .LVU146
 133:../../tmk_core/common/action_tapping.c ****                     return true;
 705               		.loc 1 133 21 view .LVU147
 706 01b0 C701      		movw r24,r14
 707               	.LVL44:
 133:../../tmk_core/common/action_tapping.c ****                     return true;
 708               		.loc 1 133 21 is_stmt 0 view .LVU148
 709 01b2 0E94 0000 		call process_action
 710               	.LVL45:
 134:../../tmk_core/common/action_tapping.c ****                 }
 711               		.loc 1 134 21 is_stmt 1 view .LVU149
 712               	.L48:
 134:../../tmk_core/common/action_tapping.c ****                 }
 713               		.loc 1 134 21 is_stmt 0 view .LVU150
 714 01b6 CB2C      		mov r12,r11
 715               	.LVL46:
 134:../../tmk_core/common/action_tapping.c ****                 }
 716               		.loc 1 134 21 view .LVU151
 717 01b8 00C0      		rjmp .L29
 718               	.LVL47:
 719               	.L37:
 134:../../tmk_core/common/action_tapping.c ****                 }
 720               		.loc 1 134 21 view .LVU152
 721               	.LBE41:
 147:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 722               		.loc 1 147 17 is_stmt 1 discriminator 1 view .LVU153
 147:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 723               		.loc 1 147 21 is_stmt 0 discriminator 1 view .LVU154
 724 01ba 5213      		cpse r21,r18
 725 01bc 00C0      		rjmp .L51
 147:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 726               		.loc 1 147 21 discriminator 2 view .LVU155
 727 01be 3413      		cpse r19,r20
 728 01c0 00C0      		rjmp .L51
 149:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 729               		.loc 1 149 31 discriminator 3 view .LVU156
 730 01c2 D701      		movw r26,r14
 147:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 731               		.loc 1 147 47 discriminator 3 view .LVU157
 732 01c4 DD20      		tst r13
 733 01c6 01F4      		brne .+2
 734 01c8 00C0      		rjmp .L127
 735               	.L51:
 155:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 736               		.loc 1 155 22 is_stmt 1 view .LVU158
 155:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 737               		.loc 1 155 26 is_stmt 0 view .LVU159
 738 01ca 4F83      		std Y+7,r20
 739 01cc 2887      		std Y+8,r18
 740 01ce D986      		std Y+9,r13
 741 01d0 702F      		mov r23,r16
 742 01d2 1B87      		std Y+11,r17
 743 01d4 0A87      		std Y+10,r16
 744 01d6 522F      		mov r21,r18
 745 01d8 6D2D      		mov r22,r13
 746 01da 8B85      		ldd r24,Y+11
 747 01dc 0E94 0000 		call is_tap_key
 748               	.LVL48:
 155:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 749               		.loc 1 155 25 view .LVU160
 750 01e0 8823      		tst r24
 751 01e2 01F4      		brne .+2
 752 01e4 00C0      		rjmp .L63
 155:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 753               		.loc 1 155 44 discriminator 1 view .LVU161
 754 01e6 DD20      		tst r13
 755 01e8 01F4      		brne .+2
 756 01ea 00C0      		rjmp .L63
 156:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 757               		.loc 1 156 21 is_stmt 1 view .LVU162
 156:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 758               		.loc 1 156 40 is_stmt 0 view .LVU163
 759 01ec 8091 0000 		lds r24,tapping_key+5
 156:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 760               		.loc 1 156 24 view .LVU164
 761 01f0 8032      		cpi r24,lo8(32)
 762 01f2 00F0      		brlo .L54
 763               	.LBB42:
 157:../../tmk_core/common/action_tapping.c ****                         // unregister key
 764               		.loc 1 157 25 is_stmt 1 view .LVU165
 159:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 765               		.loc 1 159 25 view .LVU166
 159:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 766               		.loc 1 159 54 is_stmt 0 view .LVU167
 767 01f4 2091 0000 		lds r18,tapping_key
 768 01f8 3091 0000 		lds r19,tapping_key+1
 769 01fc 3A83      		std Y+2,r19
 770 01fe 2983      		std Y+1,r18
 771 0200 1B82      		std Y+3,__zero_reg__
 772 0202 1D83      		std Y+5,r17
 773 0204 0C83      		std Y+4,r16
 774 0206 8E83      		std Y+6,r24
 159:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 775               		.loc 1 159 25 view .LVU168
 776 0208 CE01      		movw r24,r28
 777 020a 0196      		adiw r24,1
 778 020c 0E94 0000 		call process_action
 779               	.LVL49:
 780               	.L54:
 159:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 781               		.loc 1 159 25 view .LVU169
 782               	.LBE42:
 166:../../tmk_core/common/action_tapping.c ****                     }
 783               		.loc 1 166 25 is_stmt 1 view .LVU170
 168:../../tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 784               		.loc 1 168 21 view .LVU171
 168:../../tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 785               		.loc 1 168 33 is_stmt 0 view .LVU172
 786 0210 86E0      		ldi r24,lo8(6)
 787 0212 F701      		movw r30,r14
 788 0214 A0E0      		ldi r26,lo8(tapping_key)
 789 0216 B0E0      		ldi r27,hi8(tapping_key)
 790               		0:
 791 0218 0190      		ld r0,Z+
 792 021a 0D92      		st X+,r0
 793 021c 8A95      		dec r24
 794 021e 01F4      		brne 0b
 169:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 795               		.loc 1 169 21 is_stmt 1 view .LVU173
 796 0220 0E94 0000 		call waiting_buffer_scan_tap
 797               	.LVL50:
 170:../../tmk_core/common/action_tapping.c ****                     return true;
 798               		.loc 1 170 21 view .LVU174
 799 0224 0E94 0000 		call debug_tapping_key
 800               	.LVL51:
 171:../../tmk_core/common/action_tapping.c ****                 }
 801               		.loc 1 171 21 view .LVU175
 802               	.L124:
 178:../../tmk_core/common/action_tapping.c ****                 }
 803               		.loc 1 178 21 view .LVU176
 178:../../tmk_core/common/action_tapping.c ****                 }
 804               		.loc 1 178 28 is_stmt 0 view .LVU177
 805 0228 CC24      		clr r12
 806 022a C394      		inc r12
 807 022c 00C0      		rjmp .L29
 808               	.LVL52:
 809               	.L36:
 184:../../tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 810               		.loc 1 184 13 is_stmt 1 view .LVU178
 184:../../tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 811               		.loc 1 184 16 is_stmt 0 view .LVU179
 812 022e 9111      		cpse r25,__zero_reg__
 813 0230 00C0      		rjmp .L55
 814               	.LBB43:
 185:../../tmk_core/common/action_tapping.c ****                 debug_event(event); debug("\n");
 815               		.loc 1 185 17 is_stmt 1 view .LVU180
 186:../../tmk_core/common/action_tapping.c ****                 process_action(&tapping_key);
 816               		.loc 1 186 17 view .LVU181
 186:../../tmk_core/common/action_tapping.c ****                 process_action(&tapping_key);
 817               		.loc 1 186 17 is_stmt 0 view .LVU182
 818 0232 702F      		mov r23,r16
 819 0234 1B87      		std Y+11,r17
 820 0236 0A87      		std Y+10,r16
 821 0238 522F      		mov r21,r18
 822 023a 6D2D      		mov r22,r13
 823 023c 8B85      		ldd r24,Y+11
 824 023e 0E94 0000 		call debug_event
 825               	.LVL53:
 186:../../tmk_core/common/action_tapping.c ****                 process_action(&tapping_key);
 826               		.loc 1 186 37 is_stmt 1 view .LVU183
 187:../../tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 827               		.loc 1 187 17 view .LVU184
 828 0242 80E0      		ldi r24,lo8(tapping_key)
 829 0244 90E0      		ldi r25,hi8(tapping_key)
 830 0246 0E94 0000 		call process_action
 831               	.LVL54:
 188:../../tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 832               		.loc 1 188 17 view .LVU185
 188:../../tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 833               		.loc 1 188 29 is_stmt 0 view .LVU186
 834 024a 86E0      		ldi r24,lo8(6)
 835 024c F501      		movw r30,r10
 836               		0:
 837 024e 1192      		st Z+,__zero_reg__
 838 0250 8A95      		dec r24
 839 0252 01F4      		brne 0b
 840               	.L123:
 189:../../tmk_core/common/action_tapping.c ****                 return false;
 841               		.loc 1 189 17 is_stmt 1 view .LVU187
 842 0254 0E94 0000 		call debug_tapping_key
 843               	.LVL55:
 190:../../tmk_core/common/action_tapping.c ****             }  else {
 844               		.loc 1 190 17 view .LVU188
 845 0258 00C0      		rjmp .L29
 846               	.LVL56:
 847               	.L55:
 190:../../tmk_core/common/action_tapping.c ****             }  else {
 848               		.loc 1 190 17 is_stmt 0 view .LVU189
 849               	.LBE43:
 192:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 850               		.loc 1 192 17 is_stmt 1 discriminator 1 view .LVU190
 192:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 851               		.loc 1 192 21 is_stmt 0 discriminator 1 view .LVU191
 852 025a 5213      		cpse r21,r18
 853 025c 00C0      		rjmp .L51
 192:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 854               		.loc 1 192 21 discriminator 2 view .LVU192
 855 025e 3413      		cpse r19,r20
 856 0260 00C0      		rjmp .L51
 192:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 857               		.loc 1 192 47 discriminator 3 view .LVU193
 858 0262 D110      		cpse r13,__zero_reg__
 859 0264 00C0      		rjmp .L51
 860               	.LBB44:
 193:../../tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 861               		.loc 1 193 21 is_stmt 1 view .LVU194
 194:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 862               		.loc 1 194 21 view .LVU195
 194:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 863               		.loc 1 194 31 is_stmt 0 view .LVU196
 864 0266 D701      		movw r26,r14
 865 0268 1596      		adiw r26,5
 866 026a 8C93      		st X,r24
 195:../../tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 867               		.loc 1 195 21 is_stmt 1 view .LVU197
 868 026c C701      		movw r24,r14
 869 026e 0E94 0000 		call process_action
 870               	.LVL57:
 196:../../tmk_core/common/action_tapping.c ****                     return true;
 871               		.loc 1 196 21 view .LVU198
 196:../../tmk_core/common/action_tapping.c ****                     return true;
 872               		.loc 1 196 33 is_stmt 0 view .LVU199
 873 0272 86E0      		ldi r24,lo8(6)
 874 0274 F501      		movw r30,r10
 875               		0:
 876 0276 1192      		st Z+,__zero_reg__
 877 0278 8A95      		dec r24
 878 027a 01F4      		brne 0b
 197:../../tmk_core/common/action_tapping.c ****                 }
 879               		.loc 1 197 21 is_stmt 1 view .LVU200
 197:../../tmk_core/common/action_tapping.c ****                 }
 880               		.loc 1 197 28 is_stmt 0 view .LVU201
 881 027c C92C      		mov r12,r9
 882 027e 00C0      		rjmp .L29
 883               	.LVL58:
 884               	.L31:
 197:../../tmk_core/common/action_tapping.c ****                 }
 885               		.loc 1 197 28 view .LVU202
 886               	.LBE44:
 226:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 887               		.loc 1 226 12 is_stmt 1 discriminator 1 view .LVU203
 227:../../tmk_core/common/action_tapping.c ****             if (event.pressed) {
 888               		.loc 1 227 9 discriminator 1 view .LVU204
 227:../../tmk_core/common/action_tapping.c ****             if (event.pressed) {
 889               		.loc 1 227 13 is_stmt 0 discriminator 1 view .LVU205
 890 0280 0817      		cp r16,r24
 891 0282 1907      		cpc r17,r25
 892 0284 00F0      		brlo .L58
 893 0286 B801      		movw r22,r16
 894 0288 681B      		sub r22,r24
 895 028a 790B      		sbc r23,r25
 896 028c CB01      		movw r24,r22
 897               	.L129:
 227:../../tmk_core/common/action_tapping.c ****             if (event.pressed) {
 898               		.loc 1 227 13 discriminator 2 view .LVU206
 899 028e C12C      		mov r12,__zero_reg__
 900 0290 883C      		cpi r24,-56
 901 0292 9105      		cpc r25,__zero_reg__
 902 0294 00F0      		brlo .+2
 903 0296 00C0      		rjmp .L62
 228:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 904               		.loc 1 228 13 is_stmt 1 view .LVU207
 228:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 905               		.loc 1 228 22 is_stmt 0 view .LVU208
 906 0298 CD2C      		mov r12,r13
 228:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 907               		.loc 1 228 16 view .LVU209
 908 029a DD20      		tst r13
 909 029c 01F4      		brne .+2
 910 029e 00C0      		rjmp .L63
 911               	.LVL59:
 229:../../tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 912               		.loc 1 229 17 is_stmt 1 discriminator 1 view .LVU210
 229:../../tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 913               		.loc 1 229 21 is_stmt 0 discriminator 1 view .LVU211
 914 02a0 5213      		cpse r21,r18
 915 02a2 00C0      		rjmp .L64
 229:../../tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 916               		.loc 1 229 21 discriminator 2 view .LVU212
 917 02a4 3413      		cpse r19,r20
 918 02a6 00C0      		rjmp .L64
 230:../../tmk_core/common/action_tapping.c ****                         // sequential tap.
 919               		.loc 1 230 21 is_stmt 1 view .LVU213
 230:../../tmk_core/common/action_tapping.c ****                         // sequential tap.
 920               		.loc 1 230 41 is_stmt 0 view .LVU214
 921 02a8 8091 0000 		lds r24,tapping_key+5
 230:../../tmk_core/common/action_tapping.c ****                         // sequential tap.
 922               		.loc 1 230 24 view .LVU215
 923 02ac 80FD      		sbrc r24,0
 924 02ae 00C0      		rjmp .L65
 230:../../tmk_core/common/action_tapping.c ****                         // sequential tap.
 925               		.loc 1 230 79 discriminator 1 view .LVU216
 926 02b0 982F      		mov r25,r24
 927 02b2 907F      		andi r25,lo8(-16)
 230:../../tmk_core/common/action_tapping.c ****                         // sequential tap.
 928               		.loc 1 230 54 discriminator 1 view .LVU217
 929 02b4 01F0      		breq .L65
 232:../../tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 930               		.loc 1 232 25 is_stmt 1 view .LVU218
 232:../../tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 931               		.loc 1 232 35 is_stmt 0 view .LVU219
 932 02b6 D701      		movw r26,r14
 933 02b8 1596      		adiw r26,5
 934 02ba 8C93      		st X,r24
 935 02bc 1597      		sbiw r26,5
 233:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 936               		.loc 1 233 25 is_stmt 1 view .LVU220
 233:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 937               		.loc 1 233 28 is_stmt 0 view .LVU221
 938 02be 903F      		cpi r25,lo8(-16)
 939 02c0 01F0      		breq .L66
 233:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 940               		.loc 1 233 51 is_stmt 1 discriminator 1 view .LVU222
 233:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 941               		.loc 1 233 67 is_stmt 0 discriminator 1 view .LVU223
 942 02c2 982F      		mov r25,r24
 943 02c4 907F      		andi r25,lo8(-16)
 944 02c6 905F      		subi r25,lo8(-(16))
 945 02c8 8F70      		andi r24,lo8(15)
 946 02ca 892B      		or r24,r25
 947               	.LVL60:
 948               	.L127:
 233:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 949               		.loc 1 233 67 discriminator 1 view .LVU224
 950 02cc 1596      		adiw r26,5
 951 02ce 8C93      		st X,r24
 952               	.L66:
 234:../../tmk_core/common/action_tapping.c ****                         process_action(keyp);
 953               		.loc 1 234 25 is_stmt 1 view .LVU225
 234:../../tmk_core/common/action_tapping.c ****                         process_action(keyp);
 954               		.loc 1 234 55 view .LVU226
 234:../../tmk_core/common/action_tapping.c ****                         process_action(keyp);
 955               		.loc 1 234 83 view .LVU227
 235:../../tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 956               		.loc 1 235 25 view .LVU228
 957 02d0 C701      		movw r24,r14
 958 02d2 0E94 0000 		call process_action
 959               	.LVL61:
 236:../../tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 960               		.loc 1 236 25 view .LVU229
 236:../../tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 961               		.loc 1 236 37 is_stmt 0 view .LVU230
 962 02d6 86E0      		ldi r24,lo8(6)
 963 02d8 F701      		movw r30,r14
 964 02da A0E0      		ldi r26,lo8(tapping_key)
 965 02dc B0E0      		ldi r27,hi8(tapping_key)
 966               		0:
 967 02de 0190      		ld r0,Z+
 968 02e0 0D92      		st X+,r0
 969 02e2 8A95      		dec r24
 970 02e4 01F4      		brne 0b
 237:../../tmk_core/common/action_tapping.c ****                         return true;
 971               		.loc 1 237 25 is_stmt 1 view .LVU231
 972 02e6 00C0      		rjmp .L123
 973               	.LVL62:
 974               	.L58:
 227:../../tmk_core/common/action_tapping.c ****             if (event.pressed) {
 975               		.loc 1 227 13 is_stmt 0 discriminator 2 view .LVU232
 976 02e8 8095      		com r24
 977 02ea 9095      		com r25
 978 02ec 800F      		add r24,r16
 979 02ee 911F      		adc r25,r17
 980 02f0 00C0      		rjmp .L129
 981               	.LVL63:
 982               	.L65:
 241:../../tmk_core/common/action_tapping.c ****                         return true;
 983               		.loc 1 241 25 is_stmt 1 view .LVU233
 241:../../tmk_core/common/action_tapping.c ****                         return true;
 984               		.loc 1 241 37 is_stmt 0 view .LVU234
 985 02f2 86E0      		ldi r24,lo8(6)
 986 02f4 F701      		movw r30,r14
 987 02f6 A0E0      		ldi r26,lo8(tapping_key)
 988 02f8 B0E0      		ldi r27,hi8(tapping_key)
 989               		0:
 990 02fa 0190      		ld r0,Z+
 991 02fc 0D92      		st X+,r0
 992 02fe 8A95      		dec r24
 993 0300 01F4      		brne 0b
 242:../../tmk_core/common/action_tapping.c ****                     }
 994               		.loc 1 242 25 is_stmt 1 view .LVU235
 242:../../tmk_core/common/action_tapping.c ****                     }
 995               		.loc 1 242 32 is_stmt 0 view .LVU236
 996 0302 00C0      		rjmp .L29
 997               	.L64:
 244:../../tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 998               		.loc 1 244 24 is_stmt 1 view .LVU237
 244:../../tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 999               		.loc 1 244 28 is_stmt 0 view .LVU238
 1000 0304 4F83      		std Y+7,r20
 1001 0306 2887      		std Y+8,r18
 1002 0308 D986      		std Y+9,r13
 1003 030a 702F      		mov r23,r16
 1004 030c 1B87      		std Y+11,r17
 1005 030e 0A87      		std Y+10,r16
 1006 0310 522F      		mov r21,r18
 1007 0312 6D2D      		mov r22,r13
 1008 0314 8B85      		ldd r24,Y+11
 1009 0316 0E94 0000 		call is_tap_key
 1010               	.LVL64:
 244:../../tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 1011               		.loc 1 244 27 view .LVU239
 1012 031a 8111      		cpse r24,__zero_reg__
 1013 031c 00C0      		rjmp .L54
 254:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 1014               		.loc 1 254 21 is_stmt 1 view .LVU240
 254:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 1015               		.loc 1 254 49 is_stmt 0 view .LVU241
 1016 031e 8091 0000 		lds r24,tapping_key+5
 1017 0322 8160      		ori r24,lo8(1<<0)
 1018 0324 8093 0000 		sts tapping_key+5,r24
 255:../../tmk_core/common/action_tapping.c ****                     return true;
 1019               		.loc 1 255 21 is_stmt 1 view .LVU242
 1020 0328 C701      		movw r24,r14
 1021 032a 0E94 0000 		call process_action
 1022               	.LVL65:
 256:../../tmk_core/common/action_tapping.c ****                 }
 1023               		.loc 1 256 21 view .LVU243
 256:../../tmk_core/common/action_tapping.c ****                 }
 1024               		.loc 1 256 28 is_stmt 0 view .LVU244
 1025 032e 00C0      		rjmp .L29
 1026               	.LVL66:
 1027               	.L62:
 1028               	.LBB45:
 266:../../tmk_core/common/action_tapping.c ****             debug_event(event); debug("\n");
 1029               		.loc 1 266 13 is_stmt 1 view .LVU245
 267:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1030               		.loc 1 267 13 view .LVU246
 267:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1031               		.loc 1 267 13 is_stmt 0 view .LVU247
 1032 0330 702F      		mov r23,r16
 1033 0332 1B87      		std Y+11,r17
 1034 0334 0A87      		std Y+10,r16
 1035 0336 522F      		mov r21,r18
 1036 0338 6D2D      		mov r22,r13
 1037 033a 8B85      		ldd r24,Y+11
 1038 033c 0E94 0000 		call debug_event
 1039               	.LVL67:
 267:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1040               		.loc 1 267 33 is_stmt 1 view .LVU248
 268:../../tmk_core/common/action_tapping.c ****             debug_tapping_key();
 1041               		.loc 1 268 13 view .LVU249
 268:../../tmk_core/common/action_tapping.c ****             debug_tapping_key();
 1042               		.loc 1 268 25 is_stmt 0 view .LVU250
 1043 0340 86E0      		ldi r24,lo8(6)
 1044 0342 E0E0      		ldi r30,lo8(tapping_key)
 1045 0344 F0E0      		ldi r31,hi8(tapping_key)
 1046 0346 DF01      		movw r26,r30
 1047               		0:
 1048 0348 1D92      		st X+,__zero_reg__
 1049 034a 8A95      		dec r24
 1050 034c 01F4      		brne 0b
 269:../../tmk_core/common/action_tapping.c ****             return false;
 1051               		.loc 1 269 13 is_stmt 1 view .LVU251
 1052 034e 00C0      		rjmp .L123
 1053               	.LVL68:
 1054               	.L30:
 269:../../tmk_core/common/action_tapping.c ****             return false;
 1055               		.loc 1 269 13 is_stmt 0 view .LVU252
 1056               	.LBE45:
 275:../../tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1057               		.loc 1 275 9 is_stmt 1 view .LVU253
 275:../../tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1058               		.loc 1 275 12 is_stmt 0 view .LVU254
 1059 0350 DD20      		tst r13
 1060 0352 01F0      		breq .L63
 275:../../tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1061               		.loc 1 275 30 discriminator 1 view .LVU255
 1062 0354 4F83      		std Y+7,r20
 1063 0356 2887      		std Y+8,r18
 1064 0358 D986      		std Y+9,r13
 1065 035a 702F      		mov r23,r16
 1066 035c 1B87      		std Y+11,r17
 1067 035e 0A87      		std Y+10,r16
 1068 0360 522F      		mov r21,r18
 1069 0362 6D2D      		mov r22,r13
 1070 0364 8B85      		ldd r24,Y+11
 1071 0366 0E94 0000 		call is_tap_key
 1072               	.LVL69:
 275:../../tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1073               		.loc 1 275 27 discriminator 1 view .LVU256
 1074 036a 8111      		cpse r24,__zero_reg__
 1075 036c 00C0      		rjmp .L54
 1076               	.LVL70:
 1077               	.L63:
 174:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 1078               		.loc 1 174 21 is_stmt 1 view .LVU257
 175:../../tmk_core/common/action_tapping.c ****                     }
 1079               		.loc 1 175 25 view .LVU258
 177:../../tmk_core/common/action_tapping.c ****                     return true;
 1080               		.loc 1 177 21 view .LVU259
 1081 036e C701      		movw r24,r14
 1082 0370 0E94 0000 		call process_action
 1083               	.LVL71:
 1084 0374 00C0      		rjmp .L124
 1085               	.LVL72:
 1086               	.L41:
 1087               	.LBB46:
 1088               	.LBB36:
 1089               		.loc 2 51 79 is_stmt 0 view .LVU260
 1090 0376 81E0      		ldi r24,lo8(1)
 1091 0378 8D25      		eor r24,r13
 1092 037a 00C0      		rjmp .L40
 1093               	.LBE36:
 1094               	.LBE46:
 1095               		.cfi_endproc
 1096               	.LFE5:
 1098               		.section	.text.action_tapping_process,"ax",@progbits
 1099               	.global	action_tapping_process
 1101               	action_tapping_process:
 1102               	.LFB4:
  39:../../tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
 1103               		.loc 1 39 1 is_stmt 1 view -0
 1104               		.cfi_startproc
 1105 0000 CF93      		push r28
 1106               	.LCFI20:
 1107               		.cfi_def_cfa_offset 3
 1108               		.cfi_offset 28, -2
 1109 0002 DF93      		push r29
 1110               	.LCFI21:
 1111               		.cfi_def_cfa_offset 4
 1112               		.cfi_offset 29, -3
 1113 0004 CDB7      		in r28,__SP_L__
 1114 0006 DEB7      		in r29,__SP_H__
 1115               	.LCFI22:
 1116               		.cfi_def_cfa_register 28
 1117 0008 2C97      		sbiw r28,12
 1118               	.LCFI23:
 1119               		.cfi_def_cfa_offset 16
 1120 000a 0FB6      		in __tmp_reg__,__SREG__
 1121 000c F894      		cli
 1122 000e DEBF      		out __SP_H__,r29
 1123 0010 0FBE      		out __SREG__,__tmp_reg__
 1124 0012 CDBF      		out __SP_L__,r28
 1125               	/* prologue: function */
 1126               	/* frame size = 12 */
 1127               	/* stack size = 14 */
 1128               	.L__stack_usage = 14
 1129 0014 4F83      		std Y+7,r20
 1130 0016 5887      		std Y+8,r21
 1131 0018 6987      		std Y+9,r22
 1132 001a 7A87      		std Y+10,r23
 1133 001c 8B87      		std Y+11,r24
 1134 001e 9C87      		std Y+12,r25
  40:../../tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1135               		.loc 1 40 5 view .LVU262
  40:../../tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1136               		.loc 1 40 9 is_stmt 0 view .LVU263
 1137 0020 CE01      		movw r24,r28
 1138 0022 0796      		adiw r24,7
 1139 0024 0E94 0000 		call process_tapping
 1140               	.LVL73:
  40:../../tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1141               		.loc 1 40 8 view .LVU264
 1142 0028 8823      		tst r24
 1143 002a 01F0      		breq .L134
  41:../../tmk_core/common/action_tapping.c ****             debug("processed: "); debug_record(record); debug("\n");
 1144               		.loc 1 41 9 is_stmt 1 view .LVU265
 1145               	.LBB56:
 1146               	.LBI56:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1147               		.loc 2 49 20 view .LVU266
 1148               	.LBB57:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1149               		.loc 2 49 51 view .LVU267
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1150               		.loc 2 49 74 is_stmt 0 view .LVU268
 1151 002c 8A85      		ldd r24,Y+10
 1152 002e 9B85      		ldd r25,Y+11
 1153 0030 892B      		or r24,r25
 1154 0032 01F0      		breq .L142
 1155 0034 4F81      		ldd r20,Y+7
 1156 0036 5885      		ldd r21,Y+8
 1157 0038 842F      		mov r24,r20
 1158 003a 8523      		and r24,r21
 1159 003c 8F3F      		cpi r24,lo8(-1)
 1160 003e 01F0      		breq .+2
 1161 0040 00C0      		rjmp .L157
 1162               	.L142:
 1163               	.LBE57:
 1164               	.LBE56:
  58:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1165               		.loc 1 58 32 discriminator 1 view .LVU269
 1166 0042 8091 0000 		lds r24,waiting_buffer_tail
  58:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1167               		.loc 1 58 5 discriminator 1 view .LVU270
 1168 0046 9091 0000 		lds r25,waiting_buffer_head
 1169 004a 8913      		cpse r24,r25
 1170 004c 00C0      		rjmp .L140
 1171               	.L133:
 1172               	/* epilogue start */
  69:../../tmk_core/common/action_tapping.c **** 
 1173               		.loc 1 69 1 view .LVU271
 1174 004e 2C96      		adiw r28,12
 1175 0050 0FB6      		in __tmp_reg__,__SREG__
 1176 0052 F894      		cli
 1177 0054 DEBF      		out __SP_H__,r29
 1178 0056 0FBE      		out __SREG__,__tmp_reg__
 1179 0058 CDBF      		out __SP_L__,r28
 1180 005a DF91      		pop r29
 1181 005c CF91      		pop r28
 1182 005e 0895      		ret
 1183               	.L134:
  45:../../tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
 1184               		.loc 1 45 9 is_stmt 1 view .LVU272
 1185 0060 86E0      		ldi r24,lo8(6)
 1186 0062 FE01      		movw r30,r28
 1187 0064 3796      		adiw r30,7
 1188 0066 DE01      		movw r26,r28
 1189 0068 1196      		adiw r26,1
 1190               		0:
 1191 006a 0190      		ld r0,Z+
 1192 006c 0D92      		st X+,r0
 1193 006e 8A95      		dec r24
 1194 0070 01F4      		brne 0b
 1195               	.LVL74:
 1196               	.LBB58:
 1197               	.LBI58:
 292:../../tmk_core/common/action_tapping.c **** {
 1198               		.loc 1 292 6 view .LVU273
 1199               	.LBB59:
 294:../../tmk_core/common/action_tapping.c ****         return true;
 1200               		.loc 1 294 5 view .LVU274
 1201               	.LBB60:
 1202               	.LBI60:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1203               		.loc 2 49 20 view .LVU275
 1204               	.LBB61:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1205               		.loc 2 49 51 view .LVU276
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1206               		.loc 2 49 74 is_stmt 0 view .LVU277
 1207 0072 8A85      		ldd r24,Y+10
 1208 0074 9B85      		ldd r25,Y+11
 1209 0076 892B      		or r24,r25
 1210 0078 01F0      		breq .L142
 1211 007a 8885      		ldd r24,Y+8
 1212 007c 9F81      		ldd r25,Y+7
 1213 007e 8923      		and r24,r25
 1214 0080 8F3F      		cpi r24,lo8(-1)
 1215 0082 01F0      		breq .L142
 1216               	.LBE61:
 1217               	.LBE60:
 298:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1218               		.loc 1 298 5 is_stmt 1 view .LVU278
 298:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1219               		.loc 1 298 30 is_stmt 0 view .LVU279
 1220 0084 8091 0000 		lds r24,waiting_buffer_head
 1221 0088 90E0      		ldi r25,0
 1222 008a 9C01      		movw r18,r24
 1223 008c 2F5F      		subi r18,-1
 1224 008e 3F4F      		sbci r19,-1
 298:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1225               		.loc 1 298 35 view .LVU280
 1226 0090 2770      		andi r18,7
 1227 0092 3327      		clr r19
 298:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1228               		.loc 1 298 57 view .LVU281
 1229 0094 4091 0000 		lds r20,waiting_buffer_tail
 298:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1230               		.loc 1 298 8 view .LVU282
 1231 0098 4217      		cp r20,r18
 1232 009a 1306      		cpc __zero_reg__,r19
 1233 009c 01F4      		brne .L159
 1234               	.LVL75:
 298:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1235               		.loc 1 298 8 view .LVU283
 1236               	.LBE59:
 1237               	.LBE58:
 1238               	.LBB63:
  47:../../tmk_core/common/action_tapping.c ****             clear_keyboard();
 1239               		.loc 1 47 13 is_stmt 1 view .LVU284
  48:../../tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
 1240               		.loc 1 48 13 view .LVU285
 1241 009e 0E94 0000 		call clear_keyboard
 1242               	.LVL76:
  49:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1243               		.loc 1 49 13 view .LVU286
 1244               	.LBB64:
 1245               	.LBI64:
 310:../../tmk_core/common/action_tapping.c **** {
 1246               		.loc 1 310 6 view .LVU287
 1247               	.LBB65:
 312:../../tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1248               		.loc 1 312 5 view .LVU288
 312:../../tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1249               		.loc 1 312 25 is_stmt 0 view .LVU289
 1250 00a2 1092 0000 		sts waiting_buffer_head,__zero_reg__
 313:../../tmk_core/common/action_tapping.c **** }
 1251               		.loc 1 313 5 is_stmt 1 view .LVU290
 313:../../tmk_core/common/action_tapping.c **** }
 1252               		.loc 1 313 25 is_stmt 0 view .LVU291
 1253 00a6 1092 0000 		sts waiting_buffer_tail,__zero_reg__
 1254               	.LBE65:
 1255               	.LBE64:
  50:../../tmk_core/common/action_tapping.c ****         }
 1256               		.loc 1 50 13 is_stmt 1 view .LVU292
  50:../../tmk_core/common/action_tapping.c ****         }
 1257               		.loc 1 50 25 is_stmt 0 view .LVU293
 1258 00aa 86E0      		ldi r24,lo8(6)
 1259 00ac E0E0      		ldi r30,lo8(tapping_key)
 1260 00ae F0E0      		ldi r31,hi8(tapping_key)
 1261 00b0 DF01      		movw r26,r30
 1262               		0:
 1263 00b2 1D92      		st X+,__zero_reg__
 1264 00b4 8A95      		dec r24
 1265 00b6 01F4      		brne 0b
 1266 00b8 00C0      		rjmp .L142
 1267               	.LVL77:
 1268               	.L159:
  50:../../tmk_core/common/action_tapping.c ****         }
 1269               		.loc 1 50 25 view .LVU294
 1270               	.LBE63:
 1271               	.LBB66:
 1272               	.LBB62:
 303:../../tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1273               		.loc 1 303 5 is_stmt 1 view .LVU295
 303:../../tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1274               		.loc 1 303 41 is_stmt 0 view .LVU296
 1275 00ba 66E0      		ldi r22,lo8(6)
 1276 00bc 70E0      		ldi r23,0
 1277 00be 0E94 0000 		call __mulhi3
 1278 00c2 DC01      		movw r26,r24
 1279 00c4 A050      		subi r26,lo8(-(waiting_buffer))
 1280 00c6 B040      		sbci r27,hi8(-(waiting_buffer))
 1281 00c8 86E0      		ldi r24,lo8(6)
 1282 00ca FE01      		movw r30,r28
 1283 00cc 3196      		adiw r30,1
 1284               		0:
 1285 00ce 0190      		ld r0,Z+
 1286 00d0 0D92      		st X+,r0
 1287 00d2 8A95      		dec r24
 1288 00d4 01F4      		brne 0b
 304:../../tmk_core/common/action_tapping.c **** 
 1289               		.loc 1 304 5 is_stmt 1 view .LVU297
 304:../../tmk_core/common/action_tapping.c **** 
 1290               		.loc 1 304 25 is_stmt 0 view .LVU298
 1291 00d6 2093 0000 		sts waiting_buffer_head,r18
 306:../../tmk_core/common/action_tapping.c ****     return true;
 1292               		.loc 1 306 5 is_stmt 1 view .LVU299
 306:../../tmk_core/common/action_tapping.c ****     return true;
 1293               		.loc 1 306 36 view .LVU300
 1294 00da 0E94 0000 		call debug_waiting_buffer
 1295               	.LVL78:
 307:../../tmk_core/common/action_tapping.c **** }
 1296               		.loc 1 307 5 view .LVU301
 307:../../tmk_core/common/action_tapping.c **** }
 1297               		.loc 1 307 5 is_stmt 0 view .LVU302
 1298 00de 00C0      		rjmp .L142
 1299               	.L140:
 307:../../tmk_core/common/action_tapping.c **** }
 1300               		.loc 1 307 5 view .LVU303
 1301               	.LBE62:
 1302               	.LBE66:
  59:../../tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1303               		.loc 1 59 9 is_stmt 1 view .LVU304
  59:../../tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1304               		.loc 1 59 13 is_stmt 0 view .LVU305
 1305 00e0 90E0      		ldi r25,0
 1306 00e2 66E0      		ldi r22,lo8(6)
 1307 00e4 70E0      		ldi r23,0
 1308 00e6 0E94 0000 		call __mulhi3
 1309 00ea 8050      		subi r24,lo8(-(waiting_buffer))
 1310 00ec 9040      		sbci r25,hi8(-(waiting_buffer))
 1311 00ee 0E94 0000 		call process_tapping
 1312               	.LVL79:
  59:../../tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1313               		.loc 1 59 12 view .LVU306
 1314 00f2 8823      		tst r24
 1315 00f4 01F4      		brne .+2
 1316 00f6 00C0      		rjmp .L133
  60:../../tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1317               		.loc 1 60 13 is_stmt 1 view .LVU307
  60:../../tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1318               		.loc 1 60 50 view .LVU308
  60:../../tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1319               		.loc 1 60 82 view .LVU309
  61:../../tmk_core/common/action_tapping.c ****         } else {
 1320               		.loc 1 61 13 view .LVU310
 1321 00f8 8091 0000 		lds r24,waiting_buffer_tail
 1322 00fc 90E0      		ldi r25,0
 1323 00fe 66E0      		ldi r22,lo8(6)
 1324 0100 70E0      		ldi r23,0
 1325 0102 0E94 0000 		call __mulhi3
 1326 0106 FC01      		movw r30,r24
 1327 0108 E050      		subi r30,lo8(-(waiting_buffer))
 1328 010a F040      		sbci r31,hi8(-(waiting_buffer))
 1329 010c 4081      		ld r20,Z
 1330 010e 5181      		ldd r21,Z+1
 1331 0110 6281      		ldd r22,Z+2
 1332 0112 7381      		ldd r23,Z+3
 1333 0114 8481      		ldd r24,Z+4
 1334 0116 9581      		ldd r25,Z+5
 1335 0118 0E94 0000 		call debug_record
 1336               	.LVL80:
  61:../../tmk_core/common/action_tapping.c ****         } else {
 1337               		.loc 1 61 64 view .LVU311
  58:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1338               		.loc 1 58 99 is_stmt 0 view .LVU312
 1339 011c 8091 0000 		lds r24,waiting_buffer_tail
 1340 0120 90E0      		ldi r25,0
 1341 0122 0196      		adiw r24,1
  58:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1342               		.loc 1 58 104 view .LVU313
 1343 0124 8770      		andi r24,7
 1344 0126 9927      		clr r25
  58:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1345               		.loc 1 58 76 view .LVU314
 1346 0128 8093 0000 		sts waiting_buffer_tail,r24
 1347 012c 00C0      		rjmp .L142
 1348               	.L157:
  42:../../tmk_core/common/action_tapping.c ****         }
 1349               		.loc 1 42 13 is_stmt 1 view .LVU315
  42:../../tmk_core/common/action_tapping.c ****         }
 1350               		.loc 1 42 35 view .LVU316
 1351 012e 6985      		ldd r22,Y+9
 1352 0130 7A85      		ldd r23,Y+10
 1353 0132 8B85      		ldd r24,Y+11
 1354 0134 9C85      		ldd r25,Y+12
 1355 0136 0E94 0000 		call debug_record
 1356               	.LVL81:
 1357 013a 00C0      		rjmp .L142
 1358               		.cfi_endproc
 1359               	.LFE4:
 1361               		.section	.bss.waiting_buffer_tail,"aw",@nobits
 1364               	waiting_buffer_tail:
 1365 0000 00        		.zero	1
 1366               		.section	.bss.waiting_buffer_head,"aw",@nobits
 1369               	waiting_buffer_head:
 1370 0000 00        		.zero	1
 1371               		.section	.bss.waiting_buffer,"aw",@nobits
 1374               	waiting_buffer:
 1375 0000 0000 0000 		.zero	48
 1375      0000 0000 
 1375      0000 0000 
 1375      0000 0000 
 1375      0000 0000 
 1376               		.section	.bss.tapping_key,"aw",@nobits
 1379               	tapping_key:
 1380 0000 0000 0000 		.zero	6
 1380      0000 
 1381               		.text
 1382               	.Letext0:
 1383               		.file 3 "/usr/local/Cellar/avr-gcc/9.1.0/avr/include/stdint.h"
 1384               		.file 4 "../../tmk_core/common/keycode.h"
 1385               		.file 5 "../../tmk_core/common/action_code.h"
 1386               		.file 6 "../../tmk_core/common/action.h"
 1387               		.file 7 "../../tmk_core/common/action_layer.h"
 1388               		.file 8 "../../tmk_core/common/timer.h"
 1389               		.file 9 "../../tmk_core/common/avr/xprintf.h"
 1390               		.file 10 "../../tmk_core/common/debug.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 action_tapping.c
/var/folders/cl/jr07md_52y31f_27z07pkw7h0000gp/T//cc7xX0Q5.s:2      *ABS*:000000000000003e __SP_H__
/var/folders/cl/jr07md_52y31f_27z07pkw7h0000gp/T//cc7xX0Q5.s:3      *ABS*:000000000000003d __SP_L__
/var/folders/cl/jr07md_52y31f_27z07pkw7h0000gp/T//cc7xX0Q5.s:4      *ABS*:000000000000003f __SREG__
/var/folders/cl/jr07md_52y31f_27z07pkw7h0000gp/T//cc7xX0Q5.s:5      *ABS*:0000000000000000 __tmp_reg__
/var/folders/cl/jr07md_52y31f_27z07pkw7h0000gp/T//cc7xX0Q5.s:6      *ABS*:0000000000000001 __zero_reg__
/var/folders/cl/jr07md_52y31f_27z07pkw7h0000gp/T//cc7xX0Q5.s:12     .text.debug_waiting_buffer:0000000000000000 debug_waiting_buffer
/var/folders/cl/jr07md_52y31f_27z07pkw7h0000gp/T//cc7xX0Q5.s:1364   .bss.waiting_buffer_tail:0000000000000000 waiting_buffer_tail
/var/folders/cl/jr07md_52y31f_27z07pkw7h0000gp/T//cc7xX0Q5.s:1369   .bss.waiting_buffer_head:0000000000000000 waiting_buffer_head
/var/folders/cl/jr07md_52y31f_27z07pkw7h0000gp/T//cc7xX0Q5.s:1374   .bss.waiting_buffer:0000000000000000 waiting_buffer
/var/folders/cl/jr07md_52y31f_27z07pkw7h0000gp/T//cc7xX0Q5.s:86     .text.debug_tapping_key:0000000000000000 debug_tapping_key
/var/folders/cl/jr07md_52y31f_27z07pkw7h0000gp/T//cc7xX0Q5.s:1379   .bss.tapping_key:0000000000000000 tapping_key
/var/folders/cl/jr07md_52y31f_27z07pkw7h0000gp/T//cc7xX0Q5.s:109    .text.waiting_buffer_scan_tap:0000000000000000 waiting_buffer_scan_tap
/var/folders/cl/jr07md_52y31f_27z07pkw7h0000gp/T//cc7xX0Q5.s:297    .text.process_tapping:0000000000000000 process_tapping
/var/folders/cl/jr07md_52y31f_27z07pkw7h0000gp/T//cc7xX0Q5.s:1101   .text.action_tapping_process:0000000000000000 action_tapping_process

UNDEFINED SYMBOLS
__mulhi3
debug_record
process_action
layer_switch_get_action
is_tap_key
debug_event
clear_keyboard
__do_clear_bss
